<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Nested Logit Model | A Self-Instructing Course in Mode Choice Modeling</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Nested Logit Model | A Self-Instructing Course in Mode Choice Modeling" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Nested Logit Model | A Self-Instructing Course in Mode Choice Modeling" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  



<meta name="date" content="2021-05-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="other-purpose-chapter.html"/>
<link rel="next" href="nesting-selection-chapter.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />




<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Self-Instructing Course in Mode Choice Modeling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Foreword</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#original-acknowledgements"><i class="fa fa-check"></i>Original Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#r-packages"><i class="fa fa-check"></i>R Packages</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="chapter1.html"><a href="chapter1.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="chapter1.html"><a href="chapter1.html#background"><i class="fa fa-check"></i><b>1.1</b> Background</a></li>
<li class="chapter" data-level="1.2" data-path="chapter1.html"><a href="chapter1.html#use-of-disaggregate-discrete-choice-models"><i class="fa fa-check"></i><b>1.2</b> Use of Disaggregate Discrete Choice Models</a></li>
<li class="chapter" data-level="1.3" data-path="chapter1.html"><a href="chapter1.html#application-context-in-current-course"><i class="fa fa-check"></i><b>1.3</b> Application Context in Current Course</a></li>
<li class="chapter" data-level="1.4" data-path="chapter1.html"><a href="chapter1.html#urban-and-intercity-travel-mode-choice-modeling"><i class="fa fa-check"></i><b>1.4</b> Urban and Intercity Travel Mode Choice Modeling</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="chapter1.html"><a href="chapter1.html#urban-travel-mode-choice-modeling"><i class="fa fa-check"></i><b>1.4.1</b> Urban Travel Mode Choice Modeling</a></li>
<li class="chapter" data-level="1.4.2" data-path="chapter1.html"><a href="chapter1.html#intercity-mode-choice-models"><i class="fa fa-check"></i><b>1.4.2</b> Intercity Mode Choice Models</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="chapter1.html"><a href="chapter1.html#description-of-the-course"><i class="fa fa-check"></i><b>1.5</b> Description of the Course</a></li>
<li class="chapter" data-level="1.6" data-path="chapter1.html"><a href="chapter1.html#organization-of-the-course-structure"><i class="fa fa-check"></i><b>1.6</b> Organization of the Course Structure</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="elements-of-the-choice-decision-process.html"><a href="elements-of-the-choice-decision-process.html"><i class="fa fa-check"></i><b>2</b> Elements of the Choice Decision Process</a>
<ul>
<li class="chapter" data-level="2.1" data-path="elements-of-the-choice-decision-process.html"><a href="elements-of-the-choice-decision-process.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="elements-of-the-choice-decision-process.html"><a href="elements-of-the-choice-decision-process.html#the-decision-maker"><i class="fa fa-check"></i><b>2.2</b> The Decision Maker</a></li>
<li class="chapter" data-level="2.3" data-path="elements-of-the-choice-decision-process.html"><a href="elements-of-the-choice-decision-process.html#the-alternatives"><i class="fa fa-check"></i><b>2.3</b> The Alternatives</a></li>
<li class="chapter" data-level="2.4" data-path="elements-of-the-choice-decision-process.html"><a href="elements-of-the-choice-decision-process.html#attributes-of-alternatives"><i class="fa fa-check"></i><b>2.4</b> Attributes of Alternatives</a></li>
<li class="chapter" data-level="2.5" data-path="elements-of-the-choice-decision-process.html"><a href="elements-of-the-choice-decision-process.html#the-decision-rule"><i class="fa fa-check"></i><b>2.5</b> The Decision Rule</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="utility-based-choice-theory.html"><a href="utility-based-choice-theory.html"><i class="fa fa-check"></i><b>3</b> Utility-based Choice Theory</a>
<ul>
<li class="chapter" data-level="3.1" data-path="utility-based-choice-theory.html"><a href="utility-based-choice-theory.html#basic-construct-of-utility-theory"><i class="fa fa-check"></i><b>3.1</b> Basic Construct of Utility Theory</a></li>
<li class="chapter" data-level="3.2" data-path="utility-based-choice-theory.html"><a href="utility-based-choice-theory.html#deterministic-choice-concepts"><i class="fa fa-check"></i><b>3.2</b> Deterministic Choice Concepts</a></li>
<li class="chapter" data-level="3.3" data-path="utility-based-choice-theory.html"><a href="utility-based-choice-theory.html#probabilistic-choice-theory"><i class="fa fa-check"></i><b>3.3</b> Probabilistic Choice Theory</a></li>
<li class="chapter" data-level="3.4" data-path="utility-based-choice-theory.html"><a href="utility-based-choice-theory.html#components-of-the-deterministic-portion-of-the-utility-function"><i class="fa fa-check"></i><b>3.4</b> Components of the Deterministic Portion of the Utility Function</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="utility-based-choice-theory.html"><a href="utility-based-choice-theory.html#utility-associated-with-the-attributes-of-alternatives"><i class="fa fa-check"></i><b>3.4.1</b> Utility Associated with the Attributes of Alternatives</a></li>
<li class="chapter" data-level="3.4.2" data-path="utility-based-choice-theory.html"><a href="utility-based-choice-theory.html#utility-biases-due-to-excluded-variables"><i class="fa fa-check"></i><b>3.4.2</b> Utility ‘Biases’ Due to Excluded Variables</a></li>
<li class="chapter" data-level="3.4.3" data-path="utility-based-choice-theory.html"><a href="utility-based-choice-theory.html#utility-related-to-the-characteristics-of-the-decision-maker"><i class="fa fa-check"></i><b>3.4.3</b> Utility Related to the Characteristics of the Decision Maker</a></li>
<li class="chapter" data-level="3.4.4" data-path="utility-based-choice-theory.html"><a href="utility-based-choice-theory.html#utility-defined-by-interactions-between-alternative-attributes-and-decision-maker-characteristics"><i class="fa fa-check"></i><b>3.4.4</b> Utility Defined by Interactions between Alternative Attributes and Decision Maker Characteristics</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="utility-based-choice-theory.html"><a href="utility-based-choice-theory.html#additive-error-term"><i class="fa fa-check"></i><b>3.5</b> Specification of the Additive Error Term</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="the-multinomial-logit-model.html"><a href="the-multinomial-logit-model.html"><i class="fa fa-check"></i><b>4</b> The Multinomial Logit Model</a>
<ul>
<li class="chapter" data-level="4.1" data-path="the-multinomial-logit-model.html"><a href="the-multinomial-logit-model.html#overview-description-and-functional-form"><i class="fa fa-check"></i><b>4.1</b> Overview Description and Functional Form</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="the-multinomial-logit-model.html"><a href="the-multinomial-logit-model.html#the-sigmoid-or-s-shape-of-multinomial-logit-probabilities"><i class="fa fa-check"></i><b>4.1.1</b> The Sigmoid or S shape of Multinomial Logit Probabilities</a></li>
<li class="chapter" data-level="4.1.2" data-path="the-multinomial-logit-model.html"><a href="the-multinomial-logit-model.html#the-equivalent-differences-property"><i class="fa fa-check"></i><b>4.1.2</b> The Equivalent Differences Property</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="the-multinomial-logit-model.html"><a href="the-multinomial-logit-model.html#IIA-section"><i class="fa fa-check"></i><b>4.2</b> Independence of Irrelevant Alternatives Property</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="the-multinomial-logit-model.html"><a href="the-multinomial-logit-model.html#bus-paradox"><i class="fa fa-check"></i><b>4.2.1</b> The Red Bus/Blue Bus Paradox</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="the-multinomial-logit-model.html"><a href="the-multinomial-logit-model.html#example-prediction-with-multinomial-logit-model"><i class="fa fa-check"></i><b>4.3</b> Example: Prediction with Multinomial Logit Model</a></li>
<li class="chapter" data-level="4.4" data-path="the-multinomial-logit-model.html"><a href="the-multinomial-logit-model.html#measures-of-response-to-changes-in-attributes-of-alternatives"><i class="fa fa-check"></i><b>4.4</b> Measures of Response to Changes in Attributes of Alternatives</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="the-multinomial-logit-model.html"><a href="the-multinomial-logit-model.html#derivatives-of-choice-probabilities"><i class="fa fa-check"></i><b>4.4.1</b> Derivatives of Choice Probabilities</a></li>
<li class="chapter" data-level="4.4.2" data-path="the-multinomial-logit-model.html"><a href="the-multinomial-logit-model.html#elasticities-of-choice-probabilities"><i class="fa fa-check"></i><b>4.4.2</b> Elasticities of Choice Probabilities</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="the-multinomial-logit-model.html"><a href="the-multinomial-logit-model.html#measures-of-responses-to-changes-in-decision-maker-characteristics"><i class="fa fa-check"></i><b>4.5</b> Measures of Responses to Changes in Decision Maker Characteristics</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="the-multinomial-logit-model.html"><a href="the-multinomial-logit-model.html#derivatives-of-choice-probabilities-1"><i class="fa fa-check"></i><b>4.5.1</b> Derivatives of Choice Probabilities</a></li>
<li class="chapter" data-level="4.5.2" data-path="the-multinomial-logit-model.html"><a href="the-multinomial-logit-model.html#elasticities-of-choice-probabilities-1"><i class="fa fa-check"></i><b>4.5.2</b> Elasticities of Choice Probabilities</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="the-multinomial-logit-model.html"><a href="the-multinomial-logit-model.html#model-estimation-concept-and-method"><i class="fa fa-check"></i><b>4.6</b> Model Estimation: Concept and Method</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="the-multinomial-logit-model.html"><a href="the-multinomial-logit-model.html#graphical-representation-of-model-estimation"><i class="fa fa-check"></i><b>4.6.1</b> Graphical Representation of Model Estimation</a></li>
<li class="chapter" data-level="4.6.2" data-path="the-multinomial-logit-model.html"><a href="the-multinomial-logit-model.html#maximum-likelihood-estimation-theory"><i class="fa fa-check"></i><b>4.6.2</b> Maximum Likelihood Estimation Theory</a></li>
<li class="chapter" data-level="4.6.3" data-path="the-multinomial-logit-model.html"><a href="the-multinomial-logit-model.html#example-of-maximum-likelihood-estimation"><i class="fa fa-check"></i><b>4.6.3</b> Example of Maximum Likelihood Estimation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="estimation-chapter.html"><a href="estimation-chapter.html"><i class="fa fa-check"></i><b>5</b> Data Assembly and Estimation of Simple Multinomial Logit Models</a>
<ul>
<li class="chapter" data-level="5.1" data-path="estimation-chapter.html"><a href="estimation-chapter.html#estimation-intro"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="estimation-chapter.html"><a href="estimation-chapter.html#estimation-data"><i class="fa fa-check"></i><b>5.2</b> Data Requirements Overview</a></li>
<li class="chapter" data-level="5.3" data-path="estimation-chapter.html"><a href="estimation-chapter.html#estimation-collection-methods-traveller"><i class="fa fa-check"></i><b>5.3</b> Sources and Methods for Traveler and Trip Related Data Collection</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="estimation-chapter.html"><a href="estimation-chapter.html#estimation-survey-types"><i class="fa fa-check"></i><b>5.3.1</b> Travel Survey Types</a></li>
<li class="chapter" data-level="5.3.2" data-path="estimation-chapter.html"><a href="estimation-chapter.html#estimation-survey-considerations"><i class="fa fa-check"></i><b>5.3.2</b> Sampling Design Considerations</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="estimation-chapter.html"><a href="estimation-chapter.html#estimation-collection-methods"><i class="fa fa-check"></i><b>5.4</b> Methods for Collecting Mode Related Data</a></li>
<li class="chapter" data-level="5.5" data-path="estimation-chapter.html"><a href="estimation-chapter.html#estimation-data-structure"><i class="fa fa-check"></i><b>5.5</b> Data Structure for Estimation</a></li>
<li class="chapter" data-level="5.6" data-path="estimation-chapter.html"><a href="estimation-chapter.html#estimation-sf-work-data"><i class="fa fa-check"></i><b>5.6</b> Application Data for Work Mode Choice in the San Francisco Bay Area</a></li>
<li class="chapter" data-level="5.7" data-path="estimation-chapter.html"><a href="estimation-chapter.html#estimation-basic"><i class="fa fa-check"></i><b>5.7</b> Estimation of MNL Model with Basic Specification</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="estimation-chapter.html"><a href="estimation-chapter.html#informal-tests"><i class="fa fa-check"></i><b>5.7.1</b> Informal Tests</a></li>
<li class="chapter" data-level="5.7.2" data-path="estimation-chapter.html"><a href="estimation-chapter.html#overall-goodness-of-fit-measures"><i class="fa fa-check"></i><b>5.7.2</b> Overall Goodness-of-Fit Measures</a></li>
<li class="chapter" data-level="5.7.3" data-path="estimation-chapter.html"><a href="estimation-chapter.html#statistical-tests"><i class="fa fa-check"></i><b>5.7.3</b> Statistical Tests</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="estimation-chapter.html"><a href="estimation-chapter.html#estimation-value-of-time"><i class="fa fa-check"></i><b>5.8</b> Value of Time</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="estimation-chapter.html"><a href="estimation-chapter.html#value-of-time-for-linear-utility-function"><i class="fa fa-check"></i><b>5.8.1</b> Value of Time for Linear Utility Function</a></li>
<li class="chapter" data-level="5.8.2" data-path="estimation-chapter.html"><a href="estimation-chapter.html#section5-8-2"><i class="fa fa-check"></i><b>5.8.2</b> Value of Time when Cost is Interacted with another Variable</a></li>
<li class="chapter" data-level="5.8.3" data-path="estimation-chapter.html"><a href="estimation-chapter.html#value-of-time-for-time-or-cost-transformation"><i class="fa fa-check"></i><b>5.8.3</b> Value of Time for Time or Cost Transformation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="specification-chapter.html"><a href="specification-chapter.html"><i class="fa fa-check"></i><b>6</b> Model Specification Refinement: San Francisco Bay Area Work Mode Choice</a>
<ul>
<li class="chapter" data-level="6.1" data-path="specification-chapter.html"><a href="specification-chapter.html#introduction-1"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="specification-chapter.html"><a href="specification-chapter.html#alternative-specifications"><i class="fa fa-check"></i><b>6.2</b> Alternative Specifications</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="specification-chapter.html"><a href="specification-chapter.html#refinement-of-specification-for-alternative-specific-income-effects"><i class="fa fa-check"></i><b>6.2.1</b> Refinement of Specification for Alternative Specific Income Effects</a></li>
<li class="chapter" data-level="6.2.2" data-path="specification-chapter.html"><a href="specification-chapter.html#different-specifications-of-travel-time"><i class="fa fa-check"></i><b>6.2.2</b> Different Specifications of Travel Time</a></li>
<li class="chapter" data-level="6.2.3" data-path="specification-chapter.html"><a href="specification-chapter.html#including-additinal-decision-maker-related-variables"><i class="fa fa-check"></i><b>6.2.3</b> Including Additinal Decision Maker Related Variables</a></li>
<li class="chapter" data-level="6.2.4" data-path="specification-chapter.html"><a href="specification-chapter.html#section6-2-4"><i class="fa fa-check"></i><b>6.2.4</b> Including Trip Context variables</a></li>
<li class="chapter" data-level="6.2.5" data-path="specification-chapter.html"><a href="specification-chapter.html#section6-2-5"><i class="fa fa-check"></i><b>6.2.5</b> Interactions between Trip maker and/or Context Characteristics and Mode Attributes</a></li>
<li class="chapter" data-level="6.2.6" data-path="specification-chapter.html"><a href="specification-chapter.html#additional-model-refinement"><i class="fa fa-check"></i><b>6.2.6</b> Additional Model Refinement</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="specification-chapter.html"><a href="specification-chapter.html#market-segmentation"><i class="fa fa-check"></i><b>6.3</b> Market Segmentation</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="specification-chapter.html"><a href="specification-chapter.html#market-segmentation-tests"><i class="fa fa-check"></i><b>6.3.1</b> Market Segmentation Tests</a></li>
<li class="chapter" data-level="6.3.2" data-path="specification-chapter.html"><a href="specification-chapter.html#market-segmentation-example"><i class="fa fa-check"></i><b>6.3.2</b> Market Segmentation Example</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="specification-chapter.html"><a href="specification-chapter.html#summary"><i class="fa fa-check"></i><b>6.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="other-purpose-chapter.html"><a href="other-purpose-chapter.html"><i class="fa fa-check"></i><b>7</b> San Francisco Bay Area Shop / Other Mode Choice</a>
<ul>
<li class="chapter" data-level="7.1" data-path="other-purpose-chapter.html"><a href="other-purpose-chapter.html#introduction-2"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="other-purpose-chapter.html"><a href="other-purpose-chapter.html#specification-for-shopother-mode-choice-model"><i class="fa fa-check"></i><b>7.2</b> Specification for Shop/Other Mode Choice Model</a></li>
<li class="chapter" data-level="7.3" data-path="other-purpose-chapter.html"><a href="other-purpose-chapter.html#initial-model-specification"><i class="fa fa-check"></i><b>7.3</b> Initial Model Specification</a></li>
<li class="chapter" data-level="7.4" data-path="other-purpose-chapter.html"><a href="other-purpose-chapter.html#exploring-alternative-specifications"><i class="fa fa-check"></i><b>7.4</b> Exploring Alternative Specifications</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="nestedlogit-chapter.html"><a href="nestedlogit-chapter.html"><i class="fa fa-check"></i><b>8</b> Nested Logit Model</a>
<ul>
<li class="chapter" data-level="8.1" data-path="nestedlogit-chapter.html"><a href="nestedlogit-chapter.html#motivation"><i class="fa fa-check"></i><b>8.1</b> Motivation</a></li>
<li class="chapter" data-level="8.2" data-path="nestedlogit-chapter.html"><a href="nestedlogit-chapter.html#formulation-of-nested-logit-model"><i class="fa fa-check"></i><b>8.2</b> Formulation of Nested Logit Model</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="nestedlogit-chapter.html"><a href="nestedlogit-chapter.html#logsum-param"><i class="fa fa-check"></i><b>8.2.1</b> Interpretation of the Logsum Parameter</a></li>
<li class="chapter" data-level="8.2.2" data-path="nestedlogit-chapter.html"><a href="nestedlogit-chapter.html#disaggregate-direct-and-cross-elasticities"><i class="fa fa-check"></i><b>8.2.2</b> Disaggregate Direct and Cross-Elasticities</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="nestedlogit-chapter.html"><a href="nestedlogit-chapter.html#nesting-structures"><i class="fa fa-check"></i><b>8.3</b> Nesting Structures</a></li>
<li class="chapter" data-level="8.4" data-path="nestedlogit-chapter.html"><a href="nestedlogit-chapter.html#testing-NL-structures"><i class="fa fa-check"></i><b>8.4</b> Statistical Testing of Nested Logit Structures</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="nesting-selection-chapter.html"><a href="nesting-selection-chapter.html"><i class="fa fa-check"></i><b>9</b> Selecting a Preferred Nesting Structure</a>
<ul>
<li class="chapter" data-level="9.1" data-path="nesting-selection-chapter.html"><a href="nesting-selection-chapter.html#introduction-3"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="nesting-selection-chapter.html"><a href="nesting-selection-chapter.html#nested-models-for-work-trips"><i class="fa fa-check"></i><b>9.2</b> Nested Models for Work Trips</a></li>
<li class="chapter" data-level="9.3" data-path="nesting-selection-chapter.html"><a href="nesting-selection-chapter.html#nested-models-for-shop-other-trips"><i class="fa fa-check"></i><b>9.3</b> Nested Models for Shop / Other Trips</a></li>
<li class="chapter" data-level="9.4" data-path="nesting-selection-chapter.html"><a href="nesting-selection-chapter.html#practical-issues-and-implications"><i class="fa fa-check"></i><b>9.4</b> Practical Issues and Implications</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="multiple-maxima-in-nested-logit-estimation-nesting-optima-chapter.html"><a href="multiple-maxima-in-nested-logit-estimation-nesting-optima-chapter.html"><i class="fa fa-check"></i><b>10</b> Multiple Maxima in Nested Logit Estimation (#nesting-optima-chapter)</a></li>
<li class="chapter" data-level="11" data-path="aggregate-forecasting-assessment-and-application.html"><a href="aggregate-forecasting-assessment-and-application.html"><i class="fa fa-check"></i><b>11</b> Aggregate Forecasting Assessment, and Application</a>
<ul>
<li class="chapter" data-level="11.1" data-path="aggregate-forecasting-assessment-and-application.html"><a href="aggregate-forecasting-assessment-and-application.html#background-1"><i class="fa fa-check"></i><b>11.1</b> Background</a></li>
<li class="chapter" data-level="11.2" data-path="aggregate-forecasting-assessment-and-application.html"><a href="aggregate-forecasting-assessment-and-application.html#aggregate-forecasting"><i class="fa fa-check"></i><b>11.2</b> Aggregate Forecasting</a></li>
<li class="chapter" data-level="11.3" data-path="aggregate-forecasting-assessment-and-application.html"><a href="aggregate-forecasting-assessment-and-application.html#aggregate-assessment-of-travel-mode-choice-models"><i class="fa fa-check"></i><b>11.3</b> Aggregate Assessment of Travel Mode Choice Models</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="recent-advances-in-discrete-choice-modeling.html"><a href="recent-advances-in-discrete-choice-modeling.html"><i class="fa fa-check"></i><b>12</b> Recent Advances in Discrete Choice Modeling</a>
<ul>
<li class="chapter" data-level="12.1" data-path="recent-advances-in-discrete-choice-modeling.html"><a href="recent-advances-in-discrete-choice-modeling.html#the-gev-class-of-models"><i class="fa fa-check"></i><b>12.1</b> The GEV Class of Models</a></li>
<li class="chapter" data-level="12.2" data-path="recent-advances-in-discrete-choice-modeling.html"><a href="recent-advances-in-discrete-choice-modeling.html#the-mmnl-class-of-models"><i class="fa fa-check"></i><b>12.2</b> The MMNL Class of Models</a></li>
<li class="chapter" data-level="12.3" data-path="recent-advances-in-discrete-choice-modeling.html"><a href="recent-advances-in-discrete-choice-modeling.html#the-mixed-gev-class-of-models"><i class="fa fa-check"></i><b>12.3</b> The Mixed GEV Class of Models</a></li>
<li class="chapter" data-level="12.4" data-path="recent-advances-in-discrete-choice-modeling.html"><a href="recent-advances-in-discrete-choice-modeling.html#summary-1"><i class="fa fa-check"></i><b>12.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Self-Instructing Course in Mode Choice Modeling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="nestedlogit-chapter" class="section level1" number="8">
<h1><span class="header-section-number">Chapter 8</span> Nested Logit Model</h1>
<div id="motivation" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> Motivation</h2>
<p>The Multinomial Logit Model (MNL) structure has been widely used for both urban and intercity mode choice models primarily due to its simple mathematical form, ease of estimation and interpretation, and the ability to add or remove choice alternatives. However, the MNL model has been widely criticized for its Independence of Irrelevant Alternatives (IIA) property (see <a href="the-multinomial-logit-model.html#IIA-section">Section 4.2</a>. The IIA property of the MNL restricts the ratio of the choice probabilities for any pair of alternatives to be independent of the existence and characteristics of other alternatives in the choice set. This restriction implies that introduction of a new mode or improvements to any existing mode will reduce the probability of existing modes in proportion to their probabilities before the change.</p>
<p>The IIA property is a major limitation of the MNL model as it implies equal competition between all pairs of alternatives, an inappropriate assumption in many choice situations. For example, in the case of urban mode choice among drive alone, shared ride, bus and light rail; the bus and light rail alternatives are likely to be more similar to each other than they are to either of the other alternatives due to shared attributes which are not included in the measured portion of the utility function; for example, bus and light rail may have the same fare structure and operating policies, the same lack of privacy, control of the environment, and so on. Such similarities, if not included in the measured portion of the utility function, lead to correlation between the errors associated with these alternatives, a violation of the assumptions which underlie the derivation of the MNL.</p>
<p>The way in which this undesirable characteristic of the IIA property manifests itself can be illustrated using this example. Assume that the choice probabilities (for an individual or a homogeneous group of individuals) are 65%, 15%, 10% and 10% for drive alone, shared ride, bus and light rail, respectively. If the light rail service were to be improved in such a way as to increase its choice probability to 19%, the MNL model would predict that the shares of the other alternatives would decrease proportionately as shown in Table 8 1, decreasing the probability for the drive alone, shared ride and bus alternatives by a factor of 0.90. As a result, the MNL model predicts that most of the increased light rail ridership comes from drive alone (6.5%) while only 1.5% comes from car pool and 1% from bus. This is inconsistent with expectations and empirical evidence that most of the new light rail riders will be diverted from bus and carpool. This inconsistency is a direct result of the IIA property of the MNL model. Thus, in these types of choice situations, the MNL model will yield incorrect predictions of diversions from existing modes.</p>
<p>More extreme examples of this phenomenon have been described in the modeling literature. Most widely known among them is the red bus/blue bus problem described in <a href="the-multinomial-logit-model.html#bus-paradox">Section 4.2.1</a>.</p>
<p>These and numerous other examples illustrate that the IIA property is difficult to justify in situations where some alternatives compete more closely with each other than they do with other alternatives. This limitation of the MNL model results from the assumption of the independence of error terms in the utility of the alternatives <a href="utility-based-choice-theory.html#additive-error-term">Section 3.5</a>, which is used to derive the model. Different models can be derived through the use of different assumptions concerning the structure of the error distributions of alternative utilities. Among them, the Nested Logit (NL) model (Williams, 1977; McFadden, 1978; Daly and Zachary, 1978), is the simplest and most widely used. The NL model represents important deviations from the IIA property but retains most of the computational advantages of the MNL model (Borsch-Supan, 1987). The NL model is characterized by grouping (or nesting) subsets of alternatives that are more similar to each other with respect to excluded characteristics than they are to other alternatives.</p>
<p>Alternatives in a common nest exhibit a higher degree of similarity and competitiveness than alternatives in different nests. This level of competitiveness, represented by cross-elasticities between pairs of alternatives (the impact of a change in one mode on the probability of another mode) is identical for all pairs of alternatives in the nest. Complex tree structures can be developed which offer substantial flexibility in representing differential competitiveness between pairs of alternatives; however, the nesting structure imposes a system of restrictions concerning relationships between pairs of alternatives as will be discussed later in this chapter.</p>
</div>
<div id="formulation-of-nested-logit-model" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> Formulation of Nested Logit Model</h2>
<p>The derivation of the nested logit model is based on the assumption that some of
the alternatives share common components in their random error terms. That is,
the random term of the nested alternatives can be decomposed into a portion
associated with each alternative and a portion associated with groups of
alternatives. For example, consider an urban mode choice where a traveler has
four modes (drive alone, shared ride, commuter rail and bus) available for
making an intercity trip. The utility equations for these alternatives are:</p>
<p><span class="math display" id="eq:eightone">\[\begin{align}
U_{DA} &amp;= V_{DA} + \epsilon_{DA} \\
U_{SR} &amp;= V_{SR} + \epsilon_{SR} \\
U_{Bus} &amp;= V_{PT} + V_{Bus} + \epsilon_{SR} + \epsilon_{Bus} \\
U_{LTR} &amp;= V_{PT} + V_{LTR} + \epsilon_{SR} + \epsilon_{LTR}
\tag{8.1}
\end{align}\]</span></p>
<p>The utility terms for bus and light rail each include a distinct observed
component, <span class="math inline">\(V_{Bus}\)</span> and <span class="math inline">\(V_{LTR}\)</span>, and a common observed component, <span class="math inline">\(V_{PT}\)</span>,
for public transit (PT); they also include distinct random components,
<span class="math inline">\(\varepsilon_{Bus}\)</span> and <span class="math inline">\(\varepsilon_{LTR}\)</span> , and a common random component,
<span class="math inline">\(\varepsilon_{PT}\)</span> . The common error component creates a covariance between
the total errors for bus, <span class="math inline">\(\varepsilon_{PT} + \varepsilon_{Bus}\)</span> , and Light
Rail, <span class="math inline">\(\varepsilon_{PT} + \varepsilon_{LTR}\)</span> . This covariance violates the
assumption underlying the MNL model representing an increased similarity between
pairs of nested alternatives (bus and Light Rail, in this case) and leads to
greater cross-elasticity between these alternatives.</p>
<p>The total error for each of the four alternatives is assumed to be distributed
Gumbel with scale parameter equal to one, as in the MNL model. The variance of
these distributions is:</p>
<p><span class="math display" id="eq:eighttwo">\[\begin{equation}
V_{AR} (\epsilon_{DA}) =  V_{AR} (\epsilon_{SR}) = V_{AR} (\epsilon_{PT} + \epsilon_{Bus}) = V_{AR} (\epsilon_{PT} + \epsilon_{LTR}) = \pi^2/6
\tag{8.2}
\end{equation}\]</span></p>
<p>The distinct error components, <span class="math inline">\(\varepsilon_{Bus}\)</span> and <span class="math inline">\(\varepsilon_{LTR}\)</span> , also are assumed to be distributed Gumbel, but with scale parameter, <span class="math inline">\(\mu_{PT}\)</span> . However, in practice we estimate <span class="math inline">\(\theta_{PT} = \frac{1}{\mu_{PT}}\)</span>, the inverse of the Gumbel scale parameter. <span class="math inline">\(\theta_{PT}\)</span> , commonly referred to as the logsum parameter, is bounded by zero and one. That is, the variance of these distributions is:</p>
<p><span class="math display" id="eq:eightthree">\[\begin{equation}
V_{AR}(\epsilon_{Bus}) = V_{AR} (\epsilon_{LTR}) = \pi^2/(6 \mu_{PT}^2) = (\pi^2 \theta_{PT}^2)/6
\tag{8.3}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\mu_{PT}\)</span> is bounded by one and positive infinity (<span class="math inline">\(\theta_{PT}\)</span> is
bounded by zero and one) to ensure that the conditional variance for bus,
<span class="math inline">\(Var(\varepsilon_{Bus})\)</span> , is less than the total variance for bus,
<span class="math inline">\(Var(\varepsilon_{PT}+\varepsilon_{Bus})\)</span> , and similarly for Light Rail. This
is required to ensure that the variance for the common public transit error
component, <span class="math inline">\(\varepsilon_{PT}\)</span> , is non-negative. These assumptions are adequate
to derive a nested logit model using utility maximization principles. The
choice structure implied by these equations is depicted by the nesting structure
in Figure <a href="nestedlogit-chapter.html#fig:Twoleveltwoalternatives">8.1</a>, in which bus and light rail are
more similar to each other than they are to drive alone and shared ride.</p>
<p>It is convenient to interpret this structure as if there are two levels of
choice even though the derivation of the model makes no assumptions about the
structure of the choice process . The figure depicts an upper level (marginal)
choice among drive alone, shared ride, and public transit and a lower level
(conditional) choice between bus and light rail, given that public transit is
chosen.</p>
<div class="figure"><span id="fig:Twoleveltwoalternatives"></span>
<img src="img/Twoleveltwoalternatives.PNG" alt="Two-Level Nest Structure with Two Alternatives in Lower Nest" width="307" />
<p class="caption">
Figure 8.1: Two-Level Nest Structure with Two Alternatives in Lower Nest
</p>
</div>
<p>The choice probabilities for the lower level nested alternatives (commuter rail or bus), conditional on choice of these alternatives are given by:</p>
<p><span class="math display" id="eq:egihtfour">\[\begin{equation}
Pr(BUS/PT) = \frac{exp(V_{BUS}/ \theta_{PT})}{exp(V_{BUS}/ \theta_{PT}) + exp(V_{LTR}/ \theta_{PT})}
\tag{8.4}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:eightfive">\[\begin{equation}
Pr(LTR/PT) = \frac{exp(V_{LTR}/ \theta_{PT})}{exp(V_{BUS}/ \theta_{PT}) + exp(V_{LTR}/ \theta_{PT})}
\tag{8.5}
\end{equation}\]</span></p>
<p>This is the standard logit form except for the inclusion of the logsum parameter in the denominator of each utility function. The marginal choice probabilities for the drive alone, shared ride, and public transit alternatives are:</p>
<p><span class="math display" id="eq:egihtsix">\[\begin{equation}
Pr(DA) = \frac{exp(V_{DA})} {exp(V_{DA}) + exp(V_{SR}) + exp(V_{PT} + \theta_{PT} \Gamma_{PT})}
\tag{8.6}
\end{equation}\]</span><br />
</p>
<p><span class="math display" id="eq:egihtseven">\[\begin{equation}
Pr(DA) = \frac{exp(V_{SR})} {exp(V_{DA}) + exp(V_{SR}) + exp(V_{PT} + \theta_{PT} \Gamma_{PT})}
\tag{8.7}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:eighteight">\[\begin{equation}
Pr(DA) = \frac{exp(V_{PT} + \theta_{PT} \Gamma_{PT})} {exp(V_{DA}) + exp(V_{SR}) + exp(V_{PT} + \theta_{PT} \Gamma_{PT})}
\tag{8.8}
\end{equation}\]</span></p>
<p>The expected utility of the public transit alternatives equals this value, <span class="math inline">\(\Gamma_{PT}\)</span> , times the logsum parameter, <span class="math inline">\(\theta_{PT}\)</span> , plus other attributes common to the pair of alternatives, <span class="math inline">\(V_{PT}\)</span> . <span class="math inline">\(\Gamma_{PT}\)</span> is computed from the log of the sum of the exponents of the nested utilities (equations 8.4 and 8.5), commonly referred to as the “logsum” variable.</p>
<p><span class="math display" id="eq:utilitytransit">\[\begin{equation}
  \Gamma_{PT} = log \left[ exp \left( \frac{V_{Bus}}{\theta_{PT}} \right) +exp \left( \frac{V_{LTR}}{\theta_{PT}} \right) \right]
  \tag{8.9}
\end{equation}\]</span></p>
<p>An important feature of these equations is that the logsum parameter, <span class="math inline">\(\theta_{PT}\)</span>, appears in the denominator of the conditional utility for all the nested alternatives. The implication of this is that all of the utility function parameters, <span class="math inline">\(\beta\)</span>, are scaled by a common value. Since <span class="math inline">\(\theta_{PT}\)</span> is bounded by zero and one, the magnitudes of all the resultant parameters, <span class="math inline">\(\beta/\theta_{PT}\)</span>, are increased implying that the choice between the nested alternatives is more sensitive to changes to any of the variables in these functions than are alternatives not in the nest. Further, if the number of alternatives in any nest is reduced to one, the utility in the marginal model becomes identically equal to the utility for the remaining alternative. That is, if the bus alternative is not available to some travelers, the utility of the nest becomes:</p>
<p><span class="math display" id="eq:utilitytransitnest">\[\begin{align*}
  V^*_{PT} &amp;= V_{PT} + \theta_{PT} log \left[ exp \left( \frac{V_{LTR}}{\theta_{PT}} \right) \right] \\
  &amp;= V_{PT} + V_{LRT}
  \tag{8.10}
\end{align*}\]</span></p>
<p>The probability of choosing the nested alternatives can be obtained by multiplying the conditional probability of the nested alternative by the marginal probability as follows:</p>
<p><span class="math display" id="eq:probbus">\[\begin{equation}
P(Bus) = P(Bus \mid PT) \times P(PT)
  \tag{8.11}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:problightrail">\[\begin{equation}
P(Bus) = P(Bus \mid PT) \times P(PT)
  \tag{8.12}
\end{equation}\]</span></p>
<div id="logsum-param" class="section level3" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> Interpretation of the Logsum Parameter</h3>
<p>The logsum parameter, <span class="math inline">\(\theta\)</span> , (sometimes called the “dissimilarity parameter” or the “nesting coefficient”), is a function of the underlying correlation between the unobserved components for pairs of alternatives in that nest, and it characterizes the degree of substitutability between those alternatives. The value of the logsum parameter is bounded by zero and one to ensure consistency with random utility maximization principles. Different values of the parameter indicate the degree of dissimilarity between pairs of alternatives in the nest. The interpretation of different values of the logsum parameter is as follows:</p>
<ul>
<li><span class="math inline">\(\theta &gt; 1\)</span> Not consistent with the theoretical derivation. Reject NL model.</li>
<li><span class="math inline">\(\theta = 1\)</span> Implies zero correlation among mode pairs in the nest so the NL model collapses to the MNL model.</li>
<li><span class="math inline">\(0 &lt; \theta &lt; 1\)</span> Implies non-zero correlation among pairs. This range of values is appropriate for the nested logit model. Decreasing values of <span class="math inline">\(\theta\)</span> indicate increased substitution between/among alternatives in the nest.</li>
<li><span class="math inline">\(\theta = 0\)</span> Implies perfect correlation between pairs of alternatives in the nest. That is, the choice between the nested alternatives, conditional on the nest, is deterministic.</li>
<li><span class="math inline">\(\theta &lt; 0\)</span> Not consistent with the theoretical derivation. Therefore, we reject the nested logit model.</li>
</ul>
</div>
<div id="disaggregate-direct-and-cross-elasticities" class="section level3" number="8.2.2">
<h3><span class="header-section-number">8.2.2</span> Disaggregate Direct and Cross-Elasticities</h3>
<p>The differences between the nested logit model and the multinomial logit model can be illustrated by comparison of the elasticities of each alternative to changes in the value of a variable associated with it (direct elasticity) or with another alternative (cross elasticity) as reported in Table 8-2. The MNL direct- and cross-elasticity equations are the same for all alternatives. This is a manifestation of the IIA property of the MNL model.</p>
<p>However, the elasticity expressions for the NL model are differentiated between
cases in which the alternative being considered is or is not in the same nest as
the alternative which is changed. Both models produce identical direct- and
cross-elasticities when the attribute that is changed is for one of the
non-nested alternatives. However, the elasticity equations for changes in the
attributes of nested alternatives are different. These differences are
attributable to the value of <span class="math inline">\(\theta\)</span> in the elasticity equations. When
<span class="math inline">\(\theta\)</span> is equal to one, its maximum value, the expression,
<span class="math inline">\(\frac{1-\theta}{\theta}\)</span> , in the elasticity formulae in Table
<a href="#tab:nested-elasticity"><strong>??</strong></a> becomes zero and the direct and cross-elasticity
expressions for the nested alternatives collapse to the corresponding equations
for the alternatives not in the nest.</p>
<p>As the scale parameter, <span class="math inline">\(\theta\)</span> ,
decreases from one to zero, this expression increases and the direct- and
cross-elasticities within the nest become larger (possibly, much larger) than
the direct- and cross-elasticities between the nests. That is, the sensitivity
of a nested alternative to changes in its attributes or to changes in the
attributes of other nested alternatives becomes much greater than the
corresponding changes for non-nested alternatives. Although the same comparison
appears to exist between nested alternatives and similar alternatives in the MNL
model, this can only be evaluated by taking account of differences in the
<span class="math inline">\(\beta\)</span> parameters between the MNL and NL models.</p>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
</th>
<th style="text-align:center;">
Elasticity of Probability of Choosing Mode
</th>
<th style="text-align:center;">
Changes in Non-Nested Alternative, ‘j’
</th>
<th style="text-align:center;">
Changed in Nested Alternative ‘k’
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
Direct Elasticity
</td>
<td style="text-align:center;">
Multinomial Logit
</td>
<td style="text-align:center;">
<span class="math inline">\((1-P_j)\beta_{LOS}{LOS}_j\)</span>
</td>
<td style="text-align:center;">
Not Applicable
</td>
</tr>
<tr>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
Nested Logit
</td>
<td style="text-align:center;">
<span class="math inline">\((1-P_j)\beta_{LOS}{LOS}_j\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\left( (1-P_k) + \left( \frac{1-\theta_N}{\theta_N} \right) (1-P_{k|N}) \right) \times \beta_{LOS}{LOS}_k\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
Cross Elasticity: Effect on Non-Nested Alternatives
</td>
<td style="text-align:center;">
Multinomial Logit
</td>
<td style="text-align:center;">
<span class="math inline">\(-P_j \beta_{LOS}{LOS}_j\)</span>
</td>
<td style="text-align:center;">
Not Applicable
</td>
</tr>
<tr>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
Nested Logit
</td>
<td style="text-align:center;">
<span class="math inline">\(-P_j \beta_{LOS}{LOS}_j\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(-P_k \beta_{LOS}{LOS}_k\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
Cross Elasticity: Effect on Nested Alternatives
</td>
<td style="text-align:center;">
Multinomial Logit
</td>
<td style="text-align:center;">
Not Applicable
</td>
<td style="text-align:center;">
Not Applicable
</td>
</tr>
<tr>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
Nested Logit
</td>
<td style="text-align:center;">
<span class="math inline">\(-P_j \beta_{LOS}{LOS}_j\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(- \left( P_k + \left( \frac{1-\theta_N}{\theta_N} \right)(P_{k|N}) \right) \times \beta_{LOS}{LOS}_k\)</span>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="nesting-structures" class="section level2" number="8.3">
<h2><span class="header-section-number">8.3</span> Nesting Structures</h2>
<p>The assumptions underlying the model described in the preceding section (correlation of error terms for the bus and light rail alternatives) results in a two-level model with a single public transit nest for the four alternative (drive alone, shared ride, commuter rail, and bus) mode choice problem. This nesting structure is one of many possible two-level nested logit models which can be constructed for a choice set with four alternatives. The possible set of two-level nested logit models includes six combinations of two alternatives in a nest with the remaining alternatives at the upper level, four combinations of three alternatives in a nest and one at the upper level and three combinations of two alternatives in a nest and two alternatives in a parallel nest for a total of thirteen two level nest structures (Figure 8.2). The number of two level nest structures increases rapidly with the number of alternatives as shown in Table 8-3 below.</p>
<div class="figure"><span id="fig:Threetypestwolevelnests"></span>
<img src="img/Threetypestwolevelnests.PNG" alt="Three Types of Two Level Nests" width="372" />
<p class="caption">
Figure 8.2: Three Types of Two Level Nests
</p>
</div>
<p>Some of these nesting structures are likely to be behaviorally unreasonable; for
example, it doesn’t seem reasonable to include bus and car in the same nest. The
selection of a preferred nesting structure requires a combination of judgment
(about reasonable nesting structures) and statistical hypothesis testing;
specifically, testing the hypothesis that the MNL or a simpler NL model is the
true model.</p>
<p>Further, sub-groups of alternatives within any group may themselves be more
similar to each other than to other alternatives in the larger group.
Representation of these differences in similarity can result in multiple levels
of nesting, hierarchically identifying increasingly similar alternatives at each
level (Borsch-Supan, 1987). For example, in the four alternative case, the case
of three alternatives in a lower nest might represent alternatives that include
group riding (shared ride, bus and light rail). If we believe that the bus and
light rail alternatives are more similar than either alternative is to shared
ride, utility equations with the following common error terms will show an
intermediate level of error correlation among all group travel modes, and an
additional level of error correlation between commuter rail and bus.</p>
<p><span class="math display">\[\begin{equation}
\begin{split}
U_{DA} &amp; = V_{DA} + \epsilon_{DA} \\
U_{SR} &amp; = V_{GRP} + V_{SR} + \epsilon_{GRP} + \epsilon_{SR} \\
U_{Bus} &amp; = V_{GRP} + V_{PT} + V_{Bus} + \epsilon_{GRP} + \epsilon_{PT} + \epsilon_{Bus} \\
U_{LTR} &amp; = V_{GRP} + V_{PT} + V_{LTR} + \epsilon_{GRP} + \epsilon_{PT} + \epsilon_{LTR}
\end{split}
\end{equation}\]</span></p>
<p>In this case, the group travel modes (shared ride, commuter rail and bus) will be nested at the second level and commuter rail and bus will be nested at the third or lowest level as shown in Figure 8.3. In this model structure, the lower level nest is a binary choice between commuter rail and bus, conditional on choice of public transit; the second level nest represents a choice between shared ride and public transit conditional on group travel; and the highest level represents a choice between drive alone and group travel.</p>
<div class="figure"><span id="fig:Threelevelfouralternatives"></span>
<img src="img/Threelevelfouralternatives.PNG" alt="Three-Level Nest Structure for Four Alternatives" width="313" />
<p class="caption">
Figure 8.3: Three-Level Nest Structure for Four Alternatives
</p>
</div>
<p>Twelve three-level nested structures are possible with four alternatives; these
are combinations of two alternatives at the lowest level, one alternative at the
intermediate level and one alternative at the upper level.</p>
<p>The probability equations for the two-level nested logit model can be extended
readily to the three-level case as illustrated below. The probabilities for
each nested alternative in the lowest level, commuter rail or bus, conditional
on choice of public transit (PT) are given by:</p>
<p><span class="math display" id="eq:twolevelNLmodels">\[\begin{equation}
Pr(Bus \mid PT) = \frac {\exp(\frac{V_{Bus}}{\theta_{PT}})} {\exp(\frac{V_{Bus}}{\theta_{PT}}) + \exp{\frac{V_{LTR}}{\theta_{PT}}}}
\tag{8.13}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:threelevelNLmodels">\[\begin{equation}
Pr(LTR \mid PT) = \frac {\exp(\frac{V_{LTR}}{\theta_{PT}})} {\exp(\frac{V_{Bus}}{\theta_{PT}}) + \exp{\frac{V_{LTR}}{\theta_{PT}}}}
\tag{8.14}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\theta_{PT}\)</span> is the logsum parameter at the lowest (i.e. public transit) nest level.</p>
<p>The probabilities for each alternative in the second level nest, shared ride and
public transit, conditional on the choice of group travel (GRP) modes are:</p>
<p><span class="math inline">\(\Gamma_{PT}\)</span> is the “logsum” of the exponents of the nested utilites for the lower nest level:</p>
<p><span class="math display" id="eq:eighteen">\[\begin{equation}
\Gamma_{PT} = log(exp(\frac{V_{BUS}}{\theta_{PT}}) + exp(\frac{V_{LTR}}{\theta_{PT}}))
\tag{8.15}
\end{equation}\]</span></p>
<p>Finally, the probabilities for automobile and the common carrier nest are:</p>
<p><span class="math display" id="eq:eight19">\[\begin{align}
Pr(DA) = \frac{exp(V_{DA})} {exp(V_{DA}) + exp(V_{GRP} + \theta_{GRP} \Gamma_{GRP})} \\
Pr(GRP) = \frac{exp(V_{GRP} + \theta_{GRP} \Gamma_{GRP})} {exp(V_{DA}) + exp(V_{GRP} + \theta_{GRP} \Gamma_{GRP})}
\tag{8.16}
\end{align}\]</span></p>
<p>where <span class="math inline">\(\theta_{GRP}\)</span> is the logsum parameter for the intermediate level (<em>i.e.</em>,
for the common carrier modes), and <span class="math inline">\(\Gamma_{GRP}\)</span> is the logsum of the exponents
of the nested utilities for the intermediate nest:</p>
<p><span class="math display" id="eq:twenty">\[\begin{equation}
\Gamma_{GRP} = log({exp \frac{V_{SR}}{\theta_{GRP}}+ exp \frac{V_{PT} + \theta_{PT} \Gamma_{PT}}{\theta_{GRP}}})
\tag{8.17}
\end{equation}\]</span></p>
<p>The marginal probabilities of shared ride, commuter rail and bus are the product of the probabilities of each branch from the root (top of the tree) to the alternative:</p>
<p><span class="math display" id="eq:eighttopone">\[\begin{align}
Pr(SR) = Pr(SR|GRP) \times Pr(GRP) \\
Pr(BUS) = Pr(BUS|PT) \times Pr(PT|GRP) \times Pr(GRP) \\
Pr(LTR) = Pr(LTR|PT) \times Pr(PT|GRP) \times Pr(GRP) \\
\tag{8.18}
\end{align}\]</span></p>
<p>The value of the logsum parameters decrease as we go down the tree. This
follows from the requirement that the error variance at each level of the tree
must be lower than at the next higher level since the total variance for each
alternative is fixed and the variance at each level of the tree must be positive
(non-negative). The total variance for each alternative,
<span class="math inline">\(Var(\varepsilon^*_{Mode})\)</span> , is given by:</p>
<p><span class="math display" id="eq:Var-DA">\[\begin{equation}
Var(\varepsilon^*_{DA})=\frac{\pi^2}{6}
\tag{8.19}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:Var-SR">\[\begin{equation}
Var(\varepsilon^*_{SR}) = Var(\varepsilon_{SR}+\varepsilon_{GRP})
=Var(\varepsilon_{SR})+ Var(\varepsilon_{GRP}) =\frac{\pi^2}{6}
\tag{8.20}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:Var-Bus">\[\begin{equation}
Var(\varepsilon^*_{Bus}) = Var(\varepsilon_{GRP}+\varepsilon_{PT}+\varepsilon_{Bus})
=Var(\varepsilon_{GRP}) + Var(\varepsilon_{PT}) + Var(\varepsilon_{Bus}) =\frac{\pi^2}{6}
\tag{8.21}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:Var-LTR">\[\begin{equation}
Var(\varepsilon^*_{LTR}) = Var(\varepsilon_{GRP}+\varepsilon_{PT}+\varepsilon_{LTR})
=Var(\varepsilon_{GRP}) + Var(\varepsilon_{PT}) + Var(\varepsilon_{LTR}) =\frac{\pi^2}{6}
\tag{8.22}
\end{equation}\]</span></p>
<p>The variance components for alternatives, group elements and public transit elements of each alternative are shown in the following figure.</p>
<div class="figure"><span id="fig:Decompositionoferrorvariance"></span>
<img src="img/Decompositionoferrorvariance.PNG" alt="Decomposition of Error Variance" width="309" />
<p class="caption">
Figure 8.4: Decomposition of Error Variance
</p>
</div>
<p>This figure helps to explain the hierarchical restrictions on logsum parameters. <a href="nestedlogit-chapter.html#logsum-param">Section 8.2.1</a> described the initial restriction on the logsum for a single nest level or a two level tree as follows: <span class="math inline">\(0 &lt; \theta &lt; 1\)</span> . However, in multi-level tree structures, as shown in <a href="nestedlogit-chapter.html#nesting-structures">Section 8.3</a>, the logsum parameter at each level is restricted to be between zero and the logsum parameter at the next higher level of the nesting structure. Thus, in the example in Figure 8.4 above, <span class="math inline">\(0 &lt; \theta_{Grp} &lt; 1\)</span> and <span class="math inline">\(0 &lt; \theta_{PT} &lt; \theta_{Grp}\)</span> . This hierarchical restriction ensures that the variance of each error term in equations 8.22 through 8.25 is positive, as required. In particular, the variances are defined as</p>
<p><span class="math display" id="eq:Var-Total">\[\begin{equation}
Var(\varepsilon_{Total})=\frac{\pi^2}{6}
\tag{8.23}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:Var-GRP">\[\begin{equation}
Var(\varepsilon_{GRP})=\frac{\pi^2\theta^2_{GRP}}{6}
\tag{8.24}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:Var-PT">\[\begin{equation}
Var(\varepsilon_{PT})=\frac{\pi^2\theta^2_{PT}}{6}
\tag{8.25}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:Var-Total-minus-GRP">\[\begin{equation}
Var(\varepsilon_{Total}-\varepsilon_{GRP})=\frac{\pi^2}{6}(1-\theta^2_{GRP})
\tag{8.26}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:Var-GRP-minus-PT">\[\begin{equation}
Var(\varepsilon_{GRP}-\varepsilon_{PT})=\frac{\pi^2}{6}(\theta^2_{GRP}-\theta^2_{PT})
\tag{8.27}
\end{equation}\]</span></p>
<p>To ensure that all the variance components are positive, as required, the
nesting parameters must be constrained as shown
<span class="math inline">\(0 &lt; \theta_{PT} &lt; \theta_{Grp}\)</span>. These hierarchical constraints apply to all levels of nested
logit models. The examples of two-level and three-level nesting structures
shown in Figure <a href="nestedlogit-chapter.html#fig:Twoleveltwoalternatives">8.1</a> and Figure <a href="nestedlogit-chapter.html#fig:Threetypestwolevelnests">8.2</a> represent four of the twenty-eight different
nested models (13 two-level and 12 three-level) that are feasible for a
four-alternative case. The number of distinct nests increases rapidly with an
increasing number of alternatives (see Table
<a href="nestedlogit-chapter.html#tab:possible-nesting-structures">8.1</a>).</p>
<p>The large number of feasible nesting structures poses a substantial problem of
determining which one best reflects the choice behavior of the population. The
analyst’s judgment can be used to substantially reduce this to a smaller number
of realistic structures (based on our understanding of the competitive
relationships); however, the analyst needs to be cautious in excluding
structures since some apparently non-intuitive structures may have good fit
statistics and their interpretation may provide useful insight into the choice
behavior under study.</p>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:possible-nesting-structures">Table 8.1: </span>Number of Possible Nesting Structures
</caption>
<thead>
<tr>
<th style="text-align:center;">
Number of <br>Alternatives
</th>
<th style="text-align:center;">
Possible 2-Level <br>Nesting Structures
</th>
<th style="text-align:center;">
Possible 3-Level <br>Nesting Structures
</th>
<th style="text-align:center;">
Total Possible Nesting <br>Structures All Levels
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
3
</td>
</tr>
<tr>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
13
</td>
<td style="text-align:center;">
12
</td>
<td style="text-align:center;">
25
</td>
</tr>
<tr>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
50
</td>
<td style="text-align:center;">
125
</td>
<td style="text-align:center;">
235
</td>
</tr>
<tr>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
201
</td>
<td style="text-align:center;">
1040
</td>
<td style="text-align:center;">
2711
</td>
</tr>
</tbody>
</table>
</div>
<div id="testing-NL-structures" class="section level2" number="8.4">
<h2><span class="header-section-number">8.4</span> Statistical Testing of Nested Logit Structures</h2>
<p>Adopting a nested logit model implies rejection of the MNL . We can use
standard statistical tests of the hypothesis that the MNL model is the true
model since the nested logit model is a generalization of the MNL model. In the
case of multiple nests, the hypothesis that the MNL is the true model is
equivalent to the hypothesis that all the logsum parameters are equal to one.
We can use the likelihood ratio statistic with degrees of freedom equal to the
number of logsum parameters (the number of restrictions between the NL and the
MNL) to test this hypothesis. We reject the null hypothesis that the MNL model
is the correct model if the calculated value is greater than the test or
critical value for the distribution as:</p>
<p><span class="math display" id="eq:log-likelihoodtestMNLmodel">\[\begin{equation}
$\displaystyle -2 \times [l^{MNL} - l^{NL}]\ge \chi^{2}_{n}$
\tag{8.28}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(n\)</span> is the number of restrictions (nests) between the MNL and NL models.</p>
<p>In the case of a simple NL model with a single nest, we can use the t-statistic
to test the hypothesis that the logsum parameter is equal to one. Even in a
more complex NL model, we can test each logsum term to determine if a portion of
the nesting structure can be eliminated. For each case in which the hypothesis
that the logsum parameter is equal to one is not rejected, the corresponding
branch of the tree can be eliminated and the alternatives can go directly to the
next level. The t-statistics must be evaluated for the appropriate null
hypothesis. For nests directly under the root of the tree, the null hypothesis
is <span class="math inline">\(H_0: \mu_k = 1\)</span> ; for other nests, the null hypothesis is that the parameter
for that nest is equal to the parameter for the next higher nest in the tree.
That is, for a top level nest,</p>
<p><span class="math display" id="eq:toplevelnest">\[\begin{equation}
$\displaystyle t-statistic = \frac{\hat\theta - 1}{S_{k}}$
\tag{8.29}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\hat\theta\)</span> is the estimate of the logsum parameter for nest {k},
1 is the hypothesized value against which the logsum parameter is being tested;
and <span class="math inline">\(S_{k}\)</span> is the standard error of the parameter estimate.</p>
<p>For other nests,</p>
<p><span class="math display" id="eq:toplevelnest">\[\begin{equation}
$\displaystyle t-statistic = \frac{\hat\theta_{k \subset j} - \hat\theta_{j}}{\sqrt {S^{2}_{k\subset j} + S^{2}_{j}-2S_{k\subset j,j}}}$
\tag{8.29}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\hat\theta_{k\subset j}\)</span> is the estimate of the logsum parameter for nest
<span class="math inline">\(k\)</span> that is included under nest <span class="math inline">\(j\)</span>, <span class="math inline">\(\hat\theta_{j}\)</span> is the estimate of
the logsum parameter for nest <span class="math inline">\(j\)</span>, <span class="math inline">\(S^{2}_{k\subset j}\)</span> is the error variance
of the logsum parameter for nest <span class="math inline">\(k\)</span> that is included under nest <span class="math inline">\(j\)</span>, <span class="math inline">\(S^{2}_{j}\)</span>
is the error variance of the logsum parameter for nest <span class="math inline">\(j\)</span>, and <span class="math inline">\(S_{k\subset j,j}\)</span>
is the error covariance of the two logsum parameters.</p>
<p>It is important to note that these are not necessarily the test values that will
be reported by all computer programs, many of which apply the test for the null
hypothesis that the logsum is equal to zero or one only. If the test against
zero is reported , the user must obtain or calculate the standard errors of
estimate for the relevant parameters and calculate the t-statistic(s) as defined
above.</p>
<p>The likelihood ratio test can also be used to test the significance of more complex nested models or between models with different nesting structures as long as the nesting structure of one model can be obtained as a restriction of the other. To choose between two nested logit models where neither model is a restricted version of the other, we use the non-nested hypothesis test discussed in <a href="#chapter5">CHAPTER 5</a> <a href="estimation-chapter.html#section5-7-3-2">section 5.7.3.2</a>.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="other-purpose-chapter.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="nesting-selection-chapter.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>

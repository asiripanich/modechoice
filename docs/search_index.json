[
["index.html", "A Self-Instructing Course in Mode Choice Modeling Foreword Original Acknowledgements R Packages", " A Self-Instructing Course in Mode Choice Modeling Frank Koppelman Northwestern University (Emeritus)Chandra Bhat University of Texas as Austin2021-02-23 Foreword This is a re-publication of A Self-Instructing Course in Mode Choice Modeling, originally prepared by Frank Koppelman and Chandra Bhat for the Federal Transit Administration. The mathematics and instruction provided by this course have been extraordinarily helpful to a generation of choice modelers and other transportation professionals in academic and practical settings. The explosion of open-source packages for logit modeling and literate programming more generally warrants this re-publication in a programming-first context. The R code to compute the choice models in this book is embedded within the text and exposed to the viewer. In this way, the book serves not only as a primer on choice modeling, but on how to estimate and interpret choice modelers in R. This conversion project was undertaken by members of the AEP50(5) subcommittee on Travel Forecasting Resources on behalf of the transportation modeling community. The committee was aided in this conversion by the following students at Brigham Young University: Cover Photo: King’s Cross Station, London by Michał Parzuchowski on Unsplash Original Acknowledgements This manual was prepared under funding of the United States Department of Transportation through the Federal Transit Administration (Agmt. 8-17-04-A1/DTFT60-99-D-4013/0012) to AECOMConsult and Northwestern University. Valuable reviews and comments were provided by students in travel demand modeling classes at Northwestern University and the Georgia Institute of Technology. In addition, valuable comments, suggestions and questions were given by Rick Donnelly, Laurie Garrow, Joel Freedman, Chuck Purvis, Kimon Proussaloglou, Bruce Williams, Bill Woodford and others. The authors are indebted to all who commented on any version of this report but retain responsibility for any errors or omissions. R Packages In order to run the examples in this book, you will need the following packages: install.packages(&quot;tidyverse&quot;) # data munging and plots install.packages(&quot;mlogit&quot;) # choice model estimation In order to build the book for yourself, you will need the following additional packages that help build the tables and document: install.packages(&quot;bookdown&quot;) install.packages(&quot;distill&quot;) install.packages(&quot;modelsummary&quot;) "],
["chapter1.html", "Chapter 1 Introduction 1.1 Background 1.2 Use of Disaggregate Discrete Choice Models 1.3 Application Context in Current Course 1.4 Urban and Intercity Travel Mode Choice Modeling 1.5 Description of the Course 1.6 Organization of the Course Structure", " Chapter 1 Introduction 1.1 Background Discrete choice models can be used to analyze and predict a decision maker’s choice of one alternative from a finite set of mutually exclusive and collectively exhaustive alternatives. Such models have numerous applications since many behavioral responses are discrete or qualitative in nature; that is, they correspond to choices of one or another of a set of alternatives. The ultimate interest in discrete choice modeling, as in most econometric modeling, lies in being able to predict the decision making behavior of a group of individuals (we will use the term “individual” and “decision maker” interchangeably, though the decision maker may be an individual, a household, a shipper, an organization, or some other decision making entity). A further interest is to determine the relative influence of different attributes of alternatives and characteristics of decision makers when they make choice decisions. For example, transportation analysts may be interested in predicting the fraction of commuters using each of several travel modes under a variety of service conditions, or marketing researchers may be interested in examining the fraction of car buyers selecting each of several makes and models with different prices and attributes. Further, they may be interested in predicting this fraction for different groups of individuals and identifying individuals who are most likely to favor one or another alternative. Similarly, they may be interested in understanding how different groups value different attributes of an alternative; for example are business air travelers more sensitive to total travel time or the frequency of flight departures for a chosen destination. There are two basic ways of modeling such aggregate (or group) behavior. One approach directly models the aggregate share of all or a segment of decision makers choosing each alternative as a function of the characteristics of the alternatives and socio-demographic attributes of the group. This approach is commonly referred to as the aggregate approach. The second approach is to recognize that aggregate behavior is the result of numerous individual decisions and to model individual choice responses as a function of the characteristics of the alternatives available to and socio-demographic attributes of each individual. This second approach is referred to as the disaggregate approach. The disaggregate approach has several important advantages over the aggregate approach to modeling the decision making behavior of a group of individuals. First, the disaggregate approach explains why an individual makes a particular choice given her/his circumstances and is, therefore, better able to reflect changes in choice behavior due to changes in individual characteristics and attributes of alternatives. The aggregate approach, on the other hand, rests primarily on statistical associations among relevant variables at a level other than that of the decision maker; as a result, it is unable to provide accurate and reliable estimates of the change in choice behavior due changes in service or in the population. Second, the disaggregate approach, because of its causal nature, is likely to be more transferable to a different point in time and to a different geographic context, a critical requirement for prediction. Third, discrete choice models are being increasingly used to understand behavior so that the behavior may be changed in a proactive manner through carefully designed strategies that modify the attributes of alternatives which are important to individual decision makers. The disaggregate approach is more suited for proactive policy analysis since it is causal, less tied to the estimation data and more likely to include a range of relevant policy variables. Fourth, the disaggregate approach is more efficient than the aggregate approach in terms of model reliability per unit cost of data collection. Disaggregate data provide substantial variation in the behavior of interest and in the determinants of that behavior, enabling the efficient estimation of model parameters. On the other hand, aggregation leads to considerable loss in variability, thus requiring much more data to obtain the same level of model precision. Finally, disaggregate models, if properly specified, will obtain un-biased parameter estimates, while aggregate model estimates are known to produce biased (i.e. incorrect) parameter estimates. 1.2 Use of Disaggregate Discrete Choice Models The behavioral nature of disaggregate models, and the associated advantages of such models over aggregate models, has led to the widespread use of disaggregate discrete choice methods in travel demand modeling. A few of these application contexts below with references to recent work in these areas are: travel mode choice (reviewed in detail later), destination choice (C. Bhat, Govindarajan, and Pulugurta 1998; Train 1998), route choice (Yai, Iwakura, and Morichi 1997; Cascetta et al. 2002; Erhardt et al. 2003; Gliebe and Koppelman 2002), air travel choices (Proussaloglou and Koppelman 1999), activity analysis (Wen and Koppelman 1999) and auto ownership, brand and model choice (Train and others 1994; C. R. Bhat and Pulugurta 1998). Choice models have also been applied in several other fields such as purchase incidence and brand choice in marketing (Kalyanam and Putler 1997; Bucklin, Gupta, and Han 1995), housing type and location choice in geography (Waddell 1993; Evers 1990; William Sermons and Koppelman 1998), choice of intercity air carrier (Proussaloglou and Koppelman 1999) and investment choices of finance firms (Corres, Hajivassiliou, and Ioannides 1993). 1.3 Application Context in Current Course In this self-instructing course, we focus on the travel mode choice decision. Within the travel demand modeling field, mode choice is arguably the single most important determinant of the number of vehicles on roadways. The use of high-occupancy vehicle modes (such as ridesharing arrangements and transit) leads to more efficient use of the roadway infrastructure, less traffic congestion, and lower mobile-source emissions as compared to the use of single-occupancy vehicles. Further, the mode choice decision is the most easily influenced travel decision for many trips. There is a vast literature on travel mode choice modeling which has provided a good understanding of factors which influence mode choice and the general range of trade-offs individuals are willing to make among level-of-service variables (such as travel time and travel cost). The emphasis on travel mode choice in this course is a result of its important policy implications, the extensive literature to guide its development, and the limited number of alternatives involved in this decision (typically, 3 – 7 alternatives). While the methods discussed here are equally applicable to cases with many alternatives, a limited number of mode choice alternatives enable us to focus the course on important concepts and issues in discrete choice modeling without being distracted by the mechanics and presentation complexity associated with larger choice sets. 1.4 Urban and Intercity Travel Mode Choice Modeling The mode choice decision has been examined both in the context of urban travel as well as intercity travel. 1.4.1 Urban Travel Mode Choice Modeling Many metropolitan areas are plagued by a continuing increase in traffic congestion resulting in motorist frustration, longer travel times, lost productivity, increased accidents and automobile insurance rates, more fuel consumption, increased freight transportation costs, and deterioration in air quality. Aware of these serious consequences of traffic congestion, metropolitan areas are examining and implementing transportation congestion management (TCM) policies. Urban travel mode choice models are used to evaluate the effectiveness of TCM policies in shifting single-occupancy vehicle users to high-occupancy vehicle modes. The focus of urban travel mode choice modeling has been on the home-based work trip. All major metropolitan planning organizations estimate home-based work travel mode choice models as part of their transportation planning process. Most of these models include only motorized modes, though increasingly non-motorized modes (walk and bike) are being included (Lawton 1989; Purvis 1997). The modeling of home-based non-work trips and non-home-based trips has received less attention in the urban travel mode choice literature. However, the increasing number of these trips and their contribution to traffic congestion has recently led to more extensive development of models for these trip purposes in some metropolitan regions (for example, Iglesias 1997; Marshall and Ballard 1998). In this course, we discuss model-building and specification issues for home-based work and home-based shop/other trips within an urban context, though the same concepts can be immediately extended to other trip purposes and locales. 1.4.2 Intercity Mode Choice Models Increasing congestion on intercity highways and at intercity air terminals has raised serious concerns about the adverse impacts of such congestion on regional economic development, national productivity and competitiveness, and environmental quality. To alleviate current and projected congestion, attention has been directed toward identifying and evaluating alternative proposals to improve intercity transportation services. These proposals include expanding or constructing new express roadways and airports, upgrading conventional rail services and providing new high-speed ground transportation services using advanced technologies. Among other things, the a priori evaluation of such large scale projects requires the estimation of reliable intercity mode choice models to predict ridership share on the proposed new or improved intercity service and identify the modes from which existing intercity travelers will be diverted to the new (or improved) service. Intercity travel mode choice models are usually segmented by purpose (business versus pleasure), day of travel (weekday versus weekend), party size (traveling individually versus group travel), etc. The travel modes in such models typically include car, rail, air, and bus modes (Koppelman and Wen 1998; C. R. Bhat 1998; and Marwick 1993). This manual examines issues of urban model choice; however, the vast majority of approaches and specifications can and have been used in intercity mode choice modeling. 1.5 Description of the Course This self-instructing course (SIC) is designed for readers who have some familiarity with transportation planning methods and background in travel model estimation. It updates and extends the previous SIC Manual (Horowitz, Koppelman, and Lerman 1986) in a number of important ways. First, it is more rigorous in the mathematical details reflecting increased awareness and application of discrete choice models over the past decade. The course is intended to enhance the understanding of model structure and estimation procedures more so than it is intended to introduce discrete choice modeling (readers with no background in discrete choice modeling may want to work first with the earlier SIC). Second, this SIC emphasizes “hands-on” estimation experience using data sets obtained from planning and decision-oriented surveys. Consequently, there is more emphasis on data structure and more extensive examination of model specification issues. Update: this manual uses the same models and data as the 2006 Bhat / Koppelman SIC, but the models are executed in R, with the data available for download and the estimation code exposed to the reader. Third, this SIC extends the range of travel modes to include non-motorized modes and discusses issues involved in including such modes in the analysis. Fourth, this SIC includes detailed coverage of the nested logit model which is being used more commonly in many metropolitan planning organizations today. 1.6 Organization of the Course Structure This course manual is divided into twelve chapters or modules. CHAPTER 1, this chapter, provides an introduction to the course. [CHAPTER 2][Elements of the Choice Decision Process] describes the elements of the choice process including the decision maker, the alternatives, the attributes of the alternative, and the decision rule(s) adopted by the decision maker in making his/her choice. [CHAPTER 3][Utility-based Choice Theory] introduces the basic concepts of utility theory followed by a discussion of probabilistic and deterministic choice concepts and the technical components of the utility function. [CHAPTER 4][The Multinomial Logit Model] describes the Multinomial Logit (MNL) Model in detail. The discussion includes the functional form of the model, its mathematical properties, and the practical implications of these properties in model development and application. The chapter concludes with an overview of methods used for estimating the model parameters. In [CHAPTER 5][Data Assembly and Estimation of Simple Multinomial Logit Models], we first discuss the data requirements for developing disaggregate mode choice models, the potential sources for these data, and the format in which these data need to be organized for estimation. Next, the data sets used in this manual, i.e., the San Francisco Bay Area 1990 work trip mode choice (for urban area journey to work travel) and the San Francisco Bay Area Shop/Other 1990 mode choice data (for non-work travel), are described. This is followed by the development of a basic work mode choice model specification. The estimation results of this model specification are reviewed with a comprehensive discussion of informal and formal tests to evaluate the appropriateness of model parameters and the overall goodness-of-fit statistics of the model. [CHAPTER 6][Model Specification Refinement] describes and demonstrates the process by which the utility function specification for the work mode choice model can be refined using intuition, statistical analysis, testing, and judgment. Many specifications of the utility function are explored for both data sets to demonstrate some of the most common specification forms and testing methods. Starting from a base model, incremental changes are made to the modal utility functions with the objective of finding a model specification that performs better statistically, and is consistent with theory and our a priori expectations about mode choice behavior. The appropriateness of each specification change is evaluated using judgment and statistical tests. This process leads to a preferred specification for the work mode choice MNL model. [CHAPTER 7][San Francisco Bay Area Shop / Other Mode Choice] parallels [CHAPTER 6][Model Specification Refinement] for the shop/other mode choice model. [CHAPTER 8][Nested Logit Model] introduces the Nested Logit (NL) Model. The Chapter begins with the motivation for the NL model to address one of the major limitations of the MNL. The functional form and the mathematical properties of the NL are discussed in detail. This is followed by a presentation of estimation results for a number of NL model structures for the work and shop/other data sets. Based on these estimation results, statistical tests are used to compare the various NL model structures with the corresponding MNL. [CHAPTER 9][Selecting a Preferred Nesting Structure] describes the issues involved in formulating, estimating and selecting a preferred NL model. The results of statistical tests are used in conjunction with our a priori understanding of the competitive structure among different alternatives to select a final preferred nesting structure. The practical implications of choosing this preferred nesting structure in comparison to the MNL model are discussed. [CHAPTER 11][Aggregate Forecasting Assessment, and Application] describes how models estimated from disaggregate data can be used to predict a aggregate mode choice for a group of individuals from relevant information regarding the altered value (due to socio-demographic changes or policy actions) of exogenous variables. The chapter also discusses issues related to the aggregate assessment of the performance of mode choice models and the application of the models to evaluate policy actions. [CHAPTER 12][Recent Advances in Discrete Choice Modeling] provides an overview of the motivation for and structure of advanced discrete choice models. The discussion is intended to familiarize readers with a variety of models that allow increased flexibility in the representation of the choice behavior than those allowed by the multinomial logit and nested logit models. It does not provide the detailed mathematical formulations or the estimation techniques for these advanced models. Appropriate references are provided for readers interested in this information. References "],
["elements-of-the-choice-decision-process.html", "Chapter 2 Elements of the Choice Decision Process 2.1 Introduction 2.2 The Decision Maker 2.3 The Alternatives 2.4 Attributes of Alternatives 2.5 The Decision Rule", " Chapter 2 Elements of the Choice Decision Process 2.1 Introduction We observe individuals (or decision makers) making choices in a wide variety of decision contexts. However, we generally do not have information about the process individuals use to arrive at their observed choice. A proposed framework for the choice process is that an individual first determines the available alternatives; next, evaluates the attributes of each alternative relevant to the choice under consideration; and then, uses a decision rule to select an alternative from among the available alternatives (Ben-Akiva and Lerman (1985), Chapter 3). Some individuals might select a particular alternative without going through the structured process presented above. For example, an individual might decide to buy a car of the same make and model as a friend because the friend is happy with the car or is a car expert. Or an individual might purchase the same brand of ice cream out of habit. However, even in these cases, one can view the behavior within the framework of a structured decision process by assuming that the individual generates only one alternative for consideration (which is also the one chosen). In the subsequent sections, we discuss four elements associated with the choice process; the decision maker, the alternatives, the attributes of alternatives and the decision rule. 2.2 The Decision Maker The decision maker in each choice situation is the individual, group or institution which has the responsibility to make the decision at hand. The decision maker will depend on the specific choice situation. For example, the decision maker will be the individual in college choice, career choice, travel mode choice, etc.; the household in residential location choice, vacation destination choice, number of cars owned, etc.; the firm in office or warehouse location, carrier choice, employee hiring, etc. or the State (in the selection of roadway alignments). A common characteristic in the study of choice is that different decision makers face different choice situations and can have different tastes (that is, they value attributes differently). For example, in travel mode choice modeling, two individuals with different income levels and different residential locations are likely to have different sets of modes to choose from and may place different importance weights on travel time, travel cost and other attributes. These differences among decision makers should be explicitly considered in choice modeling; consequently, it is important to develop choice models at the level of the decision maker and to include variables which represent differences among the decision makers. 2.3 The Alternatives Individuals make a choice from a set of alternatives available to them. The set of available alternatives may be constrained by the environment. For example, high speed rail between two cities is an alternative only if the two cities are connected by high speed rail. The choice set determined by the environment is referred to as the universal choice set. However, even if an alternative is present in the universal choice set, it may not be feasible for a particular individual. Feasibility of an alternative for an individual in the context of travel mode choice may be determined by legal regulations (a person cannot drive alone until the age of 16), economic constraints (limousine service is not feasible for some people) or characteristics of the individual (no car available or a handicap that prevents one from driving). The subset of the universal choice set that is feasible for an individual is defined as the feasible choice set for that individual. Finally, not all alternatives in the feasible choice set may be considered by an individual in her/his choice process. For example, transit might be a feasible travel mode for an individual’s work trip, but the individual might not be aware of the availability or schedule of the transit service. The subset of the feasible choice set that an individual actually considers is referred to as the consideration choice set. This is the choice set which should be considered when modeling choice decisions. The choice set may also be determined by the decision context of the individual or the focus of the policy makers supporting the study. For example, a study of university choice may focus on choice of school type (private vs. public, small vs. large, urban vs. suburban or rural location, etc.), if the perspective is national, or a choice of specific schools, if the perspective is regional. 2.4 Attributes of Alternatives The alternatives in a choice process are characterized by a set of attribute values. Following Lancaster (1971), one can postulate that the attractiveness of an alternative is determined by the value of its attributes. The measure of uncertainty about an attribute can also be included as part of the attribute vector in addition to the attribute itself. For example, if travel time by transit is not fixed, the expected value of transit travel time and a measure of uncertainty of the transit travel time can both be included as attributes of transit. The attributes of alternatives may be generic (that is, they apply to all alternatives equally) or alternative-specific (they apply to one or a subset of alternatives). In the travel mode choice context, in-vehicle-time is usually considered to be specific to all motorized modes because it is relevant to motorized alternatives. However, if travel time by bus is considered to be very onerous due to over-crowding, bus in-vehicle-time may be defined as a distinct variable with a distinct parameter; differences between this parameter and the in-vehicle-time parameter for other motorized modes will measure the degree to which bus time is considered onerous to the traveler relative to other in-vehicle time. Other times, such as wait time at a transit stop or transfer time at a transit transfer point are relevant only to the transit modes, not for the nontransit modes. It is also common to consider the travel times for non-motorized modes (bike and walk) as specific to only these alternatives. An important reason for developing discrete choice models is to evaluate the effect of policy actions. To provide this capability, it is important to identify and include attributes whose values may be changed through pro-active policy decisions. In a travel mode choice context, these variables include measures of service (travel time, frequency, reliability of service, etc.) and travel cost. 2.5 The Decision Rule An individual invokes a decision rule (i.e., a mechanism to process information and evaluate alternatives) to select an alternative from a choice set with two or more alternatives. This decision rule may include random choice, variety seeking, or other processes which we refer to as being irrational. As indicated earlier, some individuals might use other decision rules such as “follow the leader” or habit in choosing alternatives which may also be considered to be irrational. However, even in this case, rational discrete choice models may be effective if the decision maker who adopts habitual behavior previously evaluated different alternatives and selected the best one for him/her and there have been no intervening changes in her/his alternatives and preferences. However, in the case of follow-the-leader behavior, the decision maker is considered to be rational if the “leader” is believed to share a similar value system. An individual is said to use a rational decision process if the process satisfies two fundamental constructs: consistency and transitivity. Consistency implies the same choice selection in repeated choices under identical circumstances. Transitivity implies an unique ordering of alternatives on a preference scale. Therefore, if alternative A is preferred to alternative B and alternative B is preferred to alternative C, then alternative A is preferred to alternative C. A number of possible rules fall under the purview of rational decision processes (Ben-Akiva and Lerman (1985), Chapter 3). In this course, the focus will be on one such decision rule referred to as utility maximization. The utility maximization rule is based on two fundamental concepts. The first is that the attribute vector characterizing each alternative can be reduced to a scalar utility value for that alternative. This concept implies a compensatory decision process; that is, it presumes that individuals make “trade-offs” among the attributes characterizing alternatives in determining their choice. Thus, an individual may choose a costlier travel mode if the travel time reduction offered by that mode compensates for the increased cost. The second concept is that the individual selects the alternative with the highest utility value. The focus on utility maximization in this course is based on its strong theoretical background, extensive use in the development of human decision making concepts, and amenability to statistical testing of the effects of attributes on choice. The utility maximization rule is also robust; that is, it provides a good description of the choice behavior even in cases where individuals use somewhat different decision rules. In the next chapter, we discuss the concepts and underlying principles of utility based choice theory in more detail. References "],
["utility-based-choice-theory.html", "Chapter 3 Utility-based Choice Theory 3.1 Basic Construct of Utility Theory 3.2 Deterministic Choice Concepts 3.3 Probabilistic Choice Theory 3.4 Components of the Deterministic Portion of the Utility Function 3.5 Specification of the Additive Error Term", " Chapter 3 Utility-based Choice Theory 3.1 Basic Construct of Utility Theory Utility is an indicator of value to an individual. Generally, we think about utility as being derived from the attributes of alternatives or sets of alternatives; e.g., the total set of groceries purchased in a week. The utility maximization rule states that an individual will select the alternative from his/her set of available alternatives that maximizes his or her utility. Further, the rule implies that there is a function containing attributes of alternatives and characteristics of individuals that describes an individual’s utility valuation for each alternative. The utility function, \\(U\\), has the property that an alternative is chosen if its utility is greater than the utility of all other alternatives in the individual’s choice set. Alternatively, this can be stated as alternative, \\(&#39;i&#39;\\), is chosen among a set of alternatives, if and only if the utility of alternative, \\(&#39;i&#39;\\), is greater than or equal to the utility of all alternatives , \\(&#39;j&#39;\\), in the choice set, \\(C\\). This can be expressed mathematically as: \\[\\begin{equation} U(X_i,S_t) \\geq U(X_j,S_t) \\forall j \\Rightarrow i \\succ j \\forall j \\in C \\tag{3.1} \\end{equation}\\] where \\(U(~~~)\\) is the mathematical utility function, \\(X_i,X_j\\) are vectors of attributes describing alternatives i and j, respectively (e.g., travel time, travel cost, and other relevant attributes of the available modes), \\(S_t\\) is a vector of characteristics describing individual \\(t\\), that influence his/her preferences among alternatives (e.g., household income and number of automobiles owned for travel mode choice), \\(i \\succ j\\) means the alternative to the left is preferred to the alternative to the right, and \\(\\forall j\\) means all the cases, j, in the choice set. That is, if the utility of alternative \\(i\\) is greater than or equal to the utility of all alternatives, \\(j\\); alternative \\(i\\) will be preferred and chosen from the set of alternatives, \\(C\\). The underlying concept of utility allows us to rank a series of alternatives and identify the single alternative that has highest utility. The primary implication of this ranking or ordering of alternatives is that there is no absolute reference or zero point, for utility values. Thus, the only valuation that is important is the difference in utility between pairs of alternatives; particularly whether that difference is positive or negative. Any function that produces the same preference orderings can serve as a utility function and will give the same predictions of choice, regardless of the numerical values of the utilities assigned to individual alternatives. It also follows that utility functions, which result in the same order among alternatives, are equivalent. 3.2 Deterministic Choice Concepts The utility maximization rule, which states that an individual chooses the alternative with the highest utility, implies no uncertainty in the individual’s decision process; that is, the individual is certain to choose the highest ranked alternative under the observed choice conditions. Utility models that yield certain predictions of choice are called deterministic utility models. The application of deterministic utility to the case of a decision between two alternatives is illustrated in Figure 3.1 that portrays a utility space in which the utilities of alternatives 1 and 2 are plotted along the horizontal and vertical axes, respectively, for each individual. The 45° line represents those points for which the utilities of the two alternatives are equal. Individuals B, C and D (above the equal-utility line) have higher utility for alternative 2 than for alternative 1 and are certain to choose alternative 2. Similarly, individuals A, E, and F (below the line) have higher utility for alternative 1 and are certain to choose that alternative. If deterministic utility models described behavior correctly, we would expect that an individual would make the same choice over time and that similar individuals (individuals having the same individual and household characteristics), would make the same choices when faced with the same set of alternatives. In practice, however, we observe variations in an individual’s choice and different choices among apparently similar individuals when faced with similar or even identical alternatives. For example, in studies of work trip mode choice, it is commonly observed that individuals, who are represented as having identical personal characteristics and who face the same sets of travel alternatives, choose different modes of travel to work. Further, some of these individuals vary their choices from day to day for no observable reason resulting in observed choices which appear to contradict the utility evaluations; that is, person A may choose Alternative 2 even though \\(U_1 &gt; U_2\\) or person C may choose Alternative 2 even though \\(U_2 &gt; U_1\\) . These observations raise questions about the appropriateness of deterministic utility models for modeling travel or other human behavior. The challenge is to develop a model structure that provides a reasonable representation of these unexplained variations in travel behavior. tibble(U1 = c(2.5, 2, 3, 5, 6, 6), U2 = c(1, 4, 5, 7, 4, 5), label = c(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;, &quot;E&quot;, &quot;F&quot;)) %&gt;% ggplot(aes(x = U1, y = U2, label = label)) + geom_point() + xlab(&quot;Utility for Alternative 1&quot;) + ylab(&quot;Utility for Alternative 2&quot;) + geom_abline(slope = 1, intercept = 0, lty = &quot;dotted&quot;) + geom_label() + geom_text(data = tibble(U1 = c(2,5), U2 = c(6.5, 1.5), label= c(&quot;Alt. 2 Preferred&quot;, &quot;Alt. 1 Preferred&quot;))) + scale_x_continuous(limits = c(0,8)) + scale_y_continuous(limits = c(0,8)) Figure 3.1: Illustration of Deterministic Choice There are three primary sources of error in the use of deterministic utility functions. First, the individual may have incomplete or incorrect information or misperceptions about the attributes of some or all of the alternatives. As a result, different individuals, each with different information or perceptions about the same alternatives are likely to make different choices. Second, the analyst or observer has different or incomplete information about the same attributes relative to the individuals and an inadequate understanding of the function the individual uses to evaluate the utility of each alternative. For example, the analyst may not have good measures of the reliability of a particular transit service, the likelihood of getting a seat at a particular time of day or the likelihood of finding a parking space at a suburban rail station. However, the traveler, especially if he/she is a regular user, is likely to know these things or to have opinions about them. Third, the analyst is unlikely to know, or account for, specific circumstances of the individual’s travel decision. For example, an individual’s choice of mode for the work trip may depend on whether there are family visitors or that another family member has a special travel need on a particular day. Using models which do not account for and incorporate this lack of information results in the apparent behavioral inconsistencies described above. While human behavior may be argued to be inconsistent, it can also be argued that the inconsistency is only apparent and can be attributed to the analyst’s lack of knowledge regarding the individual’s decision making process. Models that take account of this lack of information on the part of the analyst are called random utility or probabilistic choice models. 3.3 Probabilistic Choice Theory If analysts thoroughly understood all aspects of the internal decision making process of choosers as well as their perception of alternatives, they would be able to describe that process and predict mode choice using deterministic utility models. Experience has shown, however, that analysts do not have such knowledge; they do not fully understand the decision process of each individual or their perceptions of alternatives and they have no realistic possibility of obtaining this information. Therefore, mode choice models should take a form that recognizes and accommodates the analyst’s lack of information and understanding. The data and models used by analysts describe preferences and choice in terms of probabilities of choosing each alternative rather than predicting that an individual will choose a particular mode with certainty. Effectively, these probabilities reflect the population probabilities that people with the given set of characteristics and facing the same set of alternatives choose each of the alternatives. As with deterministic choice theory, the individual is assumed to choose an alternative if its utility is greater than that of any other alternative. The probability prediction of the analyst results from differences between the estimated utility values and the utility values used by the traveler. We represent this difference by decomposing the utility of the alternative, from the perspective of the decision maker, into two components. One component of the utility function represents the portion of the utility observed by the analyst, often called the deterministic (or observable) portion of the utility. The other component is the difference between the unknown utility used by the individual and the utility estimated by the analyst. Since the utility used by the decision maker is unknown, we represent this difference as a random error. Formally, we represent this by: \\[\\begin{equation} U_{it} = V_{it} + \\epsilon_{it} \\tag{3.2} \\end{equation}\\] where \\(U_{it}\\) is the true utility of the alternative \\(i\\) to the decision maker \\(t\\), (\\(U_{it}\\) is equivalent to \\(U(X_i,S_t)\\) but provides a simpler notation), \\(V_{it}\\) is the deterministic or observable portion of the utility estimated by the analyst, and \\(\\epsilon_{it}\\) is the error or the portion of the utility unkown to the analyst. The analyst does not have any information about the error term. However, the total error which is the sum of errors from many sources (imperfect information, measurement errors, omission of modal attributes, omission of the characteristics of the individual that influence his/her choice decision and/or errors in the utility function) is represented by a random variable. Different assumptions about the distribution of the random variables associated with the utility of each alternative result in different representations of the model used to describe and predict choice probabilities. The assumptions used in the development of logit type models are discussed in the next Chapter. 3.4 Components of the Deterministic Portion of the Utility Function The deterministic or observable portion (often called the systematic portion) of the utility of an alternative is a mathematical function of the attributes of the alternative and the characteristics of the decision maker. The systematic portion of utility can have any mathematical form but the function is most generally formulated as additive to simplify the estimation process. This function includes unknown parameters which are estimated in the modeling process. The systematic portion of the utility function can be broken into components that are (1) exclusively related to the attributes of alternatives, (2) exclusively related to the characteristics of the decision maker and (3) represent interactions between the attributes of alternatives and the characteristics of the decision maker. Thus, the systematic portion of utility can be represented by: \\[\\begin{equation} V_{t,i} = V(S_t) + V(X_i) + V(S_t,X_i) \\tag{3.3} \\end{equation}\\] where \\(V_{it}\\) is the systematic portion of utility of alternative i for inidivual t, \\(V(S_t)\\) is the portion of utility associated with characteristics of individual \\(t\\), \\(V(X_i)\\) is the portion of utility of alternative \\(i\\) associated with the attributes of alternative \\(i\\), and \\(V(S_t,X_i)\\) is the portion of the utility which results from interactions between the attributes of alternative \\(i\\) and the characteristics of individual \\(t\\). Each of these utility components is discussed separately 3.4.1 Utility Associated with the Attributes of Alternatives The utility component associated exclusively with alternatives includes variables that describe the attributes of alternatives. These attributes influence the utility of each alternative for all people in the population of interest. The attributes considered for inclusion in this component are service attributes which are measurable and which are expected to influence people’s preferences/choices among alternatives. These include measures of travel time, travel cost, walk access distance, transfers required, crowding, seat availability, and others. For example: * Total travel time, * In-vehicle travel time, * Out-of-vehicle travel time, * Travel cost, * Number of transfers (transit modes), * Walk distance and, * Reliability of on time arrival. These measures differ across alternatives for the same individual and also among individuals due to differences in the origin and destination locations of each person’s travel. For example, this portion of the utility function could look like: \\[\\begin{equation} V(X_i) = \\gamma_1 ~ &#39; ~ X_{i1} + \\gamma_2 ~ &#39; ~ X_{i2} + L + \\gamma_k ~ &#39; ~ X_{ik} \\tag{3.4} \\end{equation}\\] where \\(\\gamma_k\\) is the parameter which defines the direction and importance of the effect of attribute \\(k\\) on the utility of an alternative and \\(X_{ik}\\) is the value of attribute \\(k\\) for alternative \\(i\\). Thus, this portion of the utility of each alternative, \\(i\\), is the weighted sum of the attributes of alternative \\(i\\). A specific example for the Drive Alone (DA), Shared Ride (SR), and Transit (TR) alternatives is: \\[\\begin{equation} V(X_{DA}) = \\gamma_1 ~ &#39; ~ TT_{DA} + \\gamma_2 ~ &#39; ~ TC_{DA} \\tag{3.5} \\end{equation}\\] \\[\\begin{equation} V(X_{SR}) = \\gamma_1 ~ &#39; ~ TT_{SR} + \\gamma_2 ~ &#39; ~ TC_{SR} \\tag{3.6} \\end{equation}\\] \\[\\begin{equation} V(X_{TR}) = \\gamma_1 ~ &#39; ~ TT_{TR} + \\gamma_2 ~ &#39; ~ TC_{TR} + \\gamma_3 ~ &#39; ~ FREQ_{TR} \\tag{3.7} \\end{equation}\\] where \\(TT_i\\) is the travel time for mode \\(i\\) (\\(i\\) = \\(DA, SR, TR\\)) and \\(TC_i\\) is the travel cost for mode \\(i\\), and \\(FREQ_{TR}\\) is the frequency for transit services. Travel time and travel cost are generic; that is, they apply to all alternatives; frequency is specific to transit only. The parameters, \\(\\gamma_k\\), are identical for all the alternatives to which they apply. This implies that the utility value of travel time and travel cost are identical across alternatives. The possibility that travel time may be more onerous on Transit than by Drive Alone or Shared Ride could be tested by reformulating the above models to: \\[\\begin{equation} V(X_{DA}) = \\gamma_{11} \\times TT_{DA} + \\gamma_{12} \\times 0 + \\gamma_2 \\times TC_{DA} \\tag{3.8} \\end{equation}\\] \\[\\begin{equation} V(X_{SR}) = \\gamma_{11} \\times TT_{SR} + \\gamma_{12} \\times 0 + \\gamma_2 \\times TC_{SR} \\tag{3.9} \\end{equation}\\] \\[\\begin{equation} V(X_{TR}) = \\gamma_{11} \\times 0 + \\gamma_{12} \\times TT_{TR} + \\gamma_2 \\times TC_{TR} + \\gamma_3 \\times FREQ_{TR} \\tag{3.10} \\end{equation}\\] That is, two distinct parameters would be estimated for travel time; one for travel time by DA and SR, \\(\\gamma_{11}\\), and the other for travel time by TR, \\(\\gamma_{12}\\). These parameters could be compared to determine if the differences are statistically significant or large enough to be important. 3.4.2 Utility ‘Biases’ Due to Excluded Variables It has been widely observed that decision makers exhibit preferences for alternatives which cannot be explained by the observed attributes of those alternatives. These preferences are described as alternative specific preference or bias; they measure the average preference of individuals with different characteristics for an alternative relative to a ‘reference’ alternative. As will be shown in CHAPTER 4, the selection of the reference alternative does not influence the interpretation of the model estimation results. In the simplest case, we assume that the bias is the same for all decision makers. In this case, this portion of the utility function would be: \\[\\begin{equation} Bias_i = \\beta_{i0} \\times ASC_i \\tag{3.11} \\end{equation}\\] where \\(\\beta_{i0}\\) represents an increase in the utility of alternative \\(i\\) for all choosers and \\(ASC_i\\) is equal to one for alternative \\(i\\) and zero for all other alternatives. More detailed observation generally indicates that people with different personal and family characteristics have different preferences among sets of alternatives. For example, members of high income households are less likely to choose transit alternatives than low income individuals, all other things being equal. Similarly, members of households with fewer automobiles than workers are more likely to choose transit alternatives. Thus, it is useful to consider that the bias may differ across individuals as discussed in the next section. 3.4.3 Utility Related to the Characteristics of the Decision Maker The differences in ‘bias’ across individuals can be represented by incorporating personal and household variables in mode choice models. Variables commonly used for this purpose include: * Income of the traveler’s household, * Sex of traveler, * Age of traveler, * Number of automobiles in traveler’s household, * Number of workers in the traveler’s household, and * Number of adults in the traveler’s household. In some cases, these variables are combined. For example, the number of automobiles may be divided by the number of workers to indicate the availability of automobiles to each household member. This approach results in modification of the bias portion of the utility function to look like: \\[\\begin{equation} \\beta_{i0} \\times ASC_i + \\beta_{i1} \\times S_{1t} + \\beta_{i2} \\times S_{2t} + ... + \\beta_{iM} \\times S_{Mt} \\tag{3.12} \\end{equation}\\] where \\(\\beta_{im}\\) is the parameter which defines the direction and magnitude of the incremental bias due to an increase in the \\(m^{th}\\) characteristic of the decision maker (\\(m = 0\\) represents the parameter associated with the alternative specific constant) and \\(S_{mt}\\) is the value of the \\(m^{th}\\) characteristics for individual \\(t\\). For the case of three alternatives, (Drive Alone, Shared Ride and Transit), the decision maker components of the utility functions are: \\[\\begin{equation} V(S_{DA})=\\beta_{DA,0}\\times1+\\beta_{DA,1}\\times Inc_{t}+\\beta_{DA,2}\\times NCar_{t} \\tag{3.13} \\end{equation}\\] \\[\\begin{equation} V(S_{SR})=\\beta_{SR,0}\\times1+\\beta_{SR,1}\\times Inc_{t}+\\beta_{SR,2}\\times NCar_{t} \\tag{3.14} \\end{equation}\\] \\[\\begin{equation} V(S_{TR})=\\beta_{SR,0}\\times1+\\beta_{TR,1}\\times Inc_{t}+\\beta_{TR,2}\\times NCar_{t} \\tag{3.15} \\end{equation}\\] where \\(\\beta_{i0}\\) is the modal bias constant for mode \\(i\\) (\\(i\\)=DA,SR,TR), \\(Inc_{t}\\) is the household income of the traveler, \\(NCar_{t}\\) is the number of cars in the traveler’s household, and \\(\\beta_{i1}\\),\\(\\beta_{i2}\\) are mode specific parameters on income and cars, respectively, for mode \\(i\\) (\\(i\\)=DA,SR,TR) It is important to recognize that the parameters that describe the effect of traveler characteristics differ across alternatives while the variables are identical across alternatives for each individual. 3.4.4 Utility Defined by Interactions between Alternative Attributes and Decision Maker Characteristics The final component of utility takes into account differences in how attributes are evaluated by different decision makers. One effect of income, described earlier, is to increase the preference for travel by private automobile. This representation implies that the preference for DA and SR increase with income, independent of the attributes of travel by each alternative. Another way to represent the influence of income is that increasing income reduces the importance of monetary cost in the evaluation of modal alternatives. The idea that high income travelers place less importance on cost can be represented by dividing the cost of travel of an alternative by annual income or some function of annual income of the traveler or his/her household. Another interaction effect might be that different travelers evaluate travel time differently. For example, one might argue that because women commonly take increased responsibility for home maintenance and child care, they are likely to evaluate increased travel time to work more negatively than men. This could be represented by adding a variable to the model which represents the product of a dummy variable for female (one if the traveler is a woman and zero otherwise) times travel time, as illustrated below in the utility equations for a three alternative mode choice example (Drive Alone, Shared Ride, and Transit) using the same notation described previously. \\[\\begin{equation} V(X_{DA},S_{i})=\\gamma_{1}\\times TT_{DA}+\\gamma_{2}\\times TT_{DA}\\times Fem+\\gamma_{3}\\times TC_{DA} \\tag{3.16} \\end{equation}\\] \\[\\begin{equation} V(X_{SR},S_{i})=\\gamma_{1}\\times TT_{SR}+\\gamma_{2}\\times TT_{SR}\\times Fem+\\gamma_{3}\\times TC_{SR} \\tag{3.17} \\end{equation}\\] \\[\\begin{equation} V(X_{TR},S_{i})=\\gamma_{1}\\times TT_{TR}+\\gamma_{2}\\times TT_{TR}\\times Fem+\\gamma_{3}\\times TC_{TR}+\\gamma_{4}\\times FREQ_{TR} \\tag{3.18} \\end{equation}\\] In this example, \\(\\gamma_1\\) represents the utility value of one minute of travel time to men and \\(\\gamma_2\\) represents the additional utility value of one minute of travel time to women. Thus, the total utility value of one minute of travel time to women is \\(\\gamma_1+\\gamma_2\\). In this case, \\(\\gamma_1\\), is expected to be negative indicating that increased travel time reduces the utility of an alternative. \\(\\gamma_2\\) may be negative or positive, indicating that women are more or less sensitive to increases in travel time. 3.5 Specification of the Additive Error Term As described in section 3.3, the utility of each alternative is represented by a deterministic component, which is represented in the utility function by observed and measured variables, and an additive error term, \\(\\epsilon_i\\) which represents those components of the utility function which are not included in the model. In the three alternative examples used above, the total utility of each alternative can be represented by: \\[\\begin{equation} U_{DA}=V(S_t)+V(X_{DA})+V(S_t,X_{DA})+\\epsilon_{DA} \\tag{3.19} \\end{equation}\\] \\[\\begin{equation} U_{SR}=V(S_t)+V(X_{SR})+V(S_t,X_{SR})+\\epsilon_{SR} \\tag{3.20} \\end{equation}\\] \\[\\begin{equation} U_{TR}=V(S_t)+V(X_{TR})+V(S_t,X_{TR})+\\epsilon_{TR} \\tag{3.21} \\end{equation}\\] where \\(V()\\) represents the deterministics components of the utility for the alternatives, and \\(\\epsilon_i\\) represents the random components of the utility, also called the error term. The error term is included in the utility function to account for the fact that the analyst is not able to completely and correctly measure or specify all attributes that determine travelers’ mode utility assessment. By definition, error terms are unobserved and unmeasured. A wide range of distributions could be used to represent the distribution of error terms over individuals and alternatives. If we assume that the error term for each alternative represents many missing components, each of which has relatively little impact on the value of each alternative, the central limit theorem suggests that the sum of these small errors will be distributed normally. This assumption leads to the formulation of the Multinomial Probit (MNP) probabilistic choice model. However, the mathematical complexity of the MNP model; which makes it difficult to estimate, interpret and predict; has limited its use in practice. An alternative distribution assumption, described in the next chapter, leads to the formulation of the multinomial logit (MNL) model. "],
["the-multinomial-logit-model.html", "Chapter 4 The Multinomial Logit Model 4.1 Overview Description and Functional Form 4.2 Independence of Irrelevant Alternatives Property 4.3 Example: Prediction with Multinomial Logit Model 4.4 Measures of Response to Changes in Attributes of Alternatives 4.5 Measures of Responses to Changes in Decision Maker Characteristics 4.6 Model Estimation: Concept and Method", " Chapter 4 The Multinomial Logit Model library(tidyverse) ## ── Attaching packages ───────────────────────────────────────────────────────── tidyverse 1.3.0 ── ## ✓ ggplot2 3.3.2.9000 ✓ purrr 0.3.4 ## ✓ tibble 3.0.3 ✓ dplyr 1.0.2 ## ✓ tidyr 1.1.2 ✓ stringr 1.4.0 ## ✓ readr 1.3.1 ✓ forcats 0.5.0 ## Warning: package &#39;tibble&#39; was built under R version 4.0.2 ## Warning: package &#39;tidyr&#39; was built under R version 4.0.2 ## Warning: package &#39;dplyr&#39; was built under R version 4.0.2 ## ── Conflicts ──────────────────────────────────────────────────────────── tidyverse_conflicts() ── ## x dplyr::filter() masks stats::filter() ## x dplyr::lag() masks stats::lag() library(kableExtra) ## ## Attaching package: &#39;kableExtra&#39; ## The following object is masked from &#39;package:dplyr&#39;: ## ## group_rows #&#39; Create a tibble object that evaluates the named expressions passed #&#39; in as utility equation. utility_table &lt;- function(expressions){ top &lt;- tibble( Alternative = names(expressions), Expression = expressions ) %&gt;% rowwise() %&gt;% mutate( Value = eval(parse(text = Expression)), Exponent = exp(Value) ) %&gt;% ungroup() %&gt;% mutate( Probability = Exponent / sum(Exponent) ) bottom &lt;- tibble( Alternative = &quot;Total&quot;, Expression = &quot;&quot;, Value = NA, Exponent = sum(top$Exponent), Probability = sum(top$Probability) ) bind_rows(top, bottom) } 4.1 Overview Description and Functional Form The mathematical form of a discrete choice model is determined by the assumptions made regarding the error components of the utility function for each alternative as described in section 3.5. The specific assumptions that lead to the Multinomial Logit Model are (1) the error components are extreme-value (or Gumbel) distributed, (2) the error components are identically and independently distributed across alternatives, and (3) the error components are identically and independently distributed across observations/individuals. We discuss each of these assumptions below. The most common assumption for error distributions in the statistical and modeling literature is that errors are distributed normally. There are good theoretical and practical reasons for using the normal distribution for many modeling applications. However, in the case of choice models the normal distribution assumption for error terms leads to the Multinomial Probit Model (MNP) which has some properties that make it difficult to use in choice analysis.1 The Gumbel distribution is selected because it has computational advantages in a context where maximization is important, closely approximates the normal distribution (see Figure 4.1 and Figure 4.2) and produces a closed-form2 probabilistic choice model. pdf &lt;- tibble( x = seq(-5, 5, by = 0.01), Normal = dnorm(x, sd = sqrt(pi^2/6)), Gumbel = exp(-x) * exp(-exp(-x)) ) ggplot(pdf %&gt;% gather(key = &quot;Distribution&quot;, value = &quot;Probability&quot;, -x), aes(x = x, y = Probability, color = Distribution)) + geom_line() + theme_bw() Figure 4.1: Probability density function for normal and Gumbel distributions. cdf &lt;- tibble( x = seq(-4, 5, by = 0.01), Normal = pnorm(x, sd = sqrt(pi^2 / 6)), Gumbel = exp(-exp(-x)) ) ggplot(cdf %&gt;% gather(key = &quot;Distribution&quot;, value = &quot;Probability&quot;, -x), aes(x = x, y = Probability, color = Distribution)) + geom_line() + theme_bw() Figure 4.2: Cumulative density function for normal and Gumbel distributions. The Gumbel has the following cumulative distribution and probability density functions: \\[\\begin{equation} F(\\epsilon) = e^{e^{-\\mu(\\epsilon-\\eta)}} \\tag{4.1} \\end{equation}\\] \\[\\begin{equation} f(\\epsilon) = \\mu e^{-\\mu(\\epsilon-\\eta)} \\times e^{e^{-\\mu(\\epsilon-\\eta)}} \\tag{4.2} \\end{equation}\\] where \\(\\mu\\) is the scale parameter which determines the variance of the distribution and \\(\\eta\\) is the location (mode) parameter. The mean and variance of the distribution are: \\[\\begin{equation} Mean = \\eta + \\frac{0.577}{\\mu} \\tag{4.3} \\end{equation}\\] \\[\\begin{equation} Variance = \\frac{\\pi^2}{6\\mu^2} \\tag{4.4} \\end{equation}\\] The second and third assumptions state the location and variance of the distribution just as \\(\\mu\\) and \\(\\sigma^2\\) indicate the location and variance of the normal distribution. We will return to the discussion of the independence between/among alternatives in CHAPTER 8. The three assumptions, taken together, lead to the mathematical structure known as the Multinomial Logit Model (MNL), which gives the choice probabilities of each alternative as a function of the systematic portion of the utility of all the alternatives. The general expression for the probability of choosing an alternative ‘i’ (i = 1,2,.., J) from a set of J alternatives is: \\[\\begin{equation} Pr(i) = \\frac{\\exp(V_i)}{\\sum_{j=1}^{J}\\exp(V_j)} \\tag{4.5} \\end{equation}\\] Where \\(Pr(i)\\) is the probability of the decision-make choosing alternative i and \\(V_j\\) is the systematic component of the utility of alternative j. The exponential function is described in Figure 4.3 which shows the relationship between \\(\\exp(V_i)\\) and \\(V_i\\). Note that \\(\\exp(V_i)\\) is always positive and increases monotonically with \\(V_i\\). tibble( x = seq(-3,3,.1), y = exp(x)) %&gt;% ggplot(aes(x = x, y = y)) + geom_line() + xlab(bquote(V[i])) + ylab(bquote(exp(V[i]))) + theme_bw() Figure 4.3: Relationship Between \\(V_i\\) and \\(\\exp(V_i)\\) The multinomial logit (MNL) model has several important properties. We illustrate these for a case in which the decision maker has three available alternatives: Drive Alone (DA), Shared Ride (SR), and TRansit (TR). The probabilities of each alternative are given by modifying equation 4.5 for each alternative to obtain: \\[\\begin{equation} Pr(DA) = \\frac{\\exp(V_{DA})}{\\exp(V_{DA}) + \\exp(V_{SR}) + \\exp(V_{TR})} \\tag{4.6} \\end{equation}\\] \\[\\begin{equation} Pr(SR) = \\frac{\\exp(V_{SR})}{\\exp(V_{DA}) + \\exp(V_{SR}) + \\exp(V_{TR})} \\tag{4.7} \\end{equation}\\] \\[\\begin{equation} Pr(TR) = \\frac{\\exp(V_{TR})}{\\exp(V_{DA}) + \\exp(V_{SR}) + \\exp(V_{TR})} \\tag{4.8} \\end{equation}\\] where \\(Pr(DA)\\), \\(Pr(SR)\\), and \\(Pr(TR)\\) are the probabilities of the decision-maker choosing drive alone, shared ride and transit, respectively, and \\(V_{DA}\\), \\(V_{SR}\\) and \\(V_{TR}\\) are the systematic components of the utility for drive alone, shared ride, and transit alternatives, respectively. It is common to replace these three equations by a single general equation to represent the probability of any alternative and to simplify the equation by replacing the explicit summation in the denominator by the summation over alternatives as: \\[\\begin{equation} Pr(i) = \\frac{\\exp(V_{i})}{\\exp(V_{DA}) + \\exp(V_{SR}) + \\exp(V_{TR})} \\tag{4.9} \\end{equation}\\] \\[\\begin{equation} Pr(i) = \\frac{\\exp(V_{i})}{\\sum_{j=DA,SR,TR}\\exp(V_j)} \\tag{4.10} \\end{equation}\\] where i indicates the alternative for which the probability is being computed. This formulation implies that the probability of choosing an alternative increases monotonically with an increase in the systematic utility of that alternative and decreases with increases in the systematic utility of each of the other alternatives. This is illustrated in Table 4.1 showing the probability of DA as a function of its own utility (with the utilities of other alternatives held constant) and in Table ?? as a function of the utility of other alternatives with its own utility fixed. tibble( case = 1:5, vda = c(-3.0, -1.5, 0.0, 1.5, 3.0), vsr = -1.5, vtr = -0.5 ) %&gt;% mutate( p = exp(vda) / (exp(vda) + exp(vsr) + exp(vtr)) ) %&gt;% kableExtra::kbl( caption = &quot;Probability Values for Drive Alone as a Function of Drive Alone Utility (Shared Ride and Transit Utilities held constant)&quot;, col.names = c(&quot;$Case$&quot;, &quot;$V_{DA}$&quot;, &quot;$V_{SR}$&quot;, &quot;$V_{TR}$&quot;, &quot;$Pr(DA)$&quot;)) %&gt;% kableExtra::kable_styling() Table 4.1: Probability Values for Drive Alone as a Function of Drive Alone Utility (Shared Ride and Transit Utilities held constant) \\(Case\\) \\(V_{DA}\\) \\(V_{SR}\\) \\(V_{TR}\\) \\(Pr(DA)\\) 1 -3.0 -1.5 -0.5 0.0566117 2 -1.5 -1.5 -0.5 0.2119416 3 0.0 -1.5 -0.5 0.5465494 4 1.5 -1.5 -0.5 0.8437947 5 3.0 -1.5 -0.5 0.9603322 tibble( case = 6:11, vda = 0.0, vsr = c(-1.5, -1.5, -1.5, -0.5, -0.5, -0.5), vtr = c(-1.5, -1.0, -0.5, -1.5, -1.0, -0.5) ) %&gt;% mutate( p = exp(vda) / (exp(vda) + exp(vsr) + exp(vtr)) ) %&gt;% kableExtra::kbl( caption = &quot;Probability Values for Drive Alone as a Function of Shared Ride and Transit Utilties&quot;, col.names = c(&quot;$Case$&quot;, &quot;$V_{DA}$&quot;, &quot;$V_{SR}$&quot;, &quot;$V_{TR}$&quot;, &quot;$Pr(DA)$&quot;)) %&gt;% kableExtra::kable_styling() Table 4.2: Probability Values for Drive Alone as a Function of Shared Ride and Transit Utilties \\(Case\\) \\(V_{DA}\\) \\(V_{SR}\\) \\(V_{TR}\\) \\(Pr(DA)\\) 6 0 -1.5 -1.5 0.6914385 7 0 -1.5 -1.0 0.6285317 8 0 -1.5 -0.5 0.5465494 9 0 -0.5 -1.5 0.5465494 10 0 -0.5 -1.0 0.5064804 11 0 -0.5 -0.5 0.4518628 We use this three-alternative example to illustrate three important properties of the MNL: (1) its sigmoid or S shape, (2) dependence of the alternative choice probabilities on the differences in the systematic utility and (3) independence of the ratio of the choice probabilities of any pair of alternatives from the attributes and availability of other alternatives. 4.1.1 The Sigmoid or S shape of Multinomial Logit Probabilities The S shape of the MNL probabilities is illustrated in Figure ?? where the probability of choosing Drive Alone is shown as a function of its own utility, with the utilities of the other alternatives held constant. The S-shape limits the probability range between zero when the utility of DA is very low, relative to other alternatives, and one when the utility of DA is very high, relative to other alternatives. This function has very gradual slope at extreme values of DA utility, relative to the other alternatives, and is much steeper when its utility reaches a value such that its choice probability is close to one-half. This implies that if the representative utility of one alternative is very low or very high, compared with the others, a small increase in the utility of this alternative will not substantially affect its probability of being chosen. The point at which an increase in the representative utility of an alternative has the greatest effect on its probability of being chosen (i.e., the point of maximum slope along the curve) is when its representative utility is equivalent to the combined utility of the other alternatives. When this is true, a small increase in the utility of one alternative can ‘tip the balance’ and induce a large increase in the probability of the alternative being chosen (Train, 1993). #&#39; Function to compute mnl probabilities #&#39; @param vi utility of target alternative #&#39; @param ... utilities of other alternatives mnl_prob &lt;- function(vi, ...){ vj &lt;- c(...) exp(vi) / sum(exp(vj)) } u &lt;- tibble( v_da = seq(-3, 3, by = 0.01), v_tr = 0, v_walk = -0.5 ) %&gt;% rowwise() %&gt;% mutate( drive = mnl_prob(v_da, v_da, v_tr, v_walk), transit = mnl_prob(v_tr, v_da, v_tr, v_walk), walk = mnl_prob(v_walk, v_da, v_tr, v_walk) ) ggplot(u %&gt;% gather(Mode, Probability, drive, transit, walk), aes(x = v_da, y = Probability, color = Mode)) + geom_line() + xlab(&quot;Utility of Drive&quot;) + theme_bw() Figure 4.4: Probability of choosing alternatives while holding other utilities constant, \\(V_{transit} = 0, V_{walk} = -0.5\\) 4.1.2 The Equivalent Differences Property A fundamental property of the multinomial logit and other choice models is that the choice probabilities of the alternatives depend only on the differences in the systematic utilities of different alternatives and not their actual values. This can be illustrated in two ways. First, we show that the choice probability equations are unchanged if the same incremental value, say \\(\\Delta V\\), is added to the utility of each alternative. The original probabilities for the three alternatives in the example are given by: \\[\\begin{equation} Pr(i) = \\frac{\\exp(V_{i})}{\\exp(V_{DA}) + \\exp(V_{SR}) + \\exp(V_{TR})} \\tag{4.11} \\end{equation}\\] where i is the alternative for which the probabilities are being computed. Adding \\(\\Delta V\\) to the systematic components of \\(V_{DA}\\), \\(V_{SR}\\) and \\(V_{TR}\\) gives3: \\[\\begin{align*} Pr(i)&amp;= \\frac{\\exp(V_i + {\\Delta V })} {\\exp(V_{DA}+{\\Delta V }) + \\exp(V_{SR}+{\\Delta V }) + \\exp(V_{TR}+{\\Delta V })} \\\\ &amp;= \\frac{\\exp(V_i) \\times \\exp({\\Delta V })} {\\exp(V_{DA}) \\times \\exp({\\Delta V }) + \\exp(V_{SR}) \\times \\exp({\\Delta V }) + \\exp(V_{TR}) \\times \\exp({\\Delta V })} \\\\ &amp;= \\frac{\\exp(V_i) \\times \\exp({\\Delta V })}{[\\exp(V_{DA}) + \\exp(V_{SR}) + \\exp(V_{TR})] \\times \\exp({\\Delta V })} \\\\ &amp;= \\frac{\\exp(V_i)}{[\\exp(V_{DA}) + \\exp(V_{SR}) + \\exp(V_{TR})]} \\tag{4.12} \\end{align*}\\] which is the same probability as before \\(\\Delta V\\) was added to each of the utilities. This result applies to any value of \\(\\Delta V\\). We also illustrate this property through use of a numerical example for the three alternative choice problem used earlier. The following equations represent the case when the utility values for Drive Alone, Shared Ride and Transit equal 0.5, 1.5 and 3.0, respectively: \\[\\begin{equation} Pr(DA) = \\frac {\\exp(-0.5)}{\\exp(-0.5) + \\exp(-1.5) + \\exp(-3.0)} = 0.690 \\tag{4.13} \\end{equation}\\] \\[\\begin{equation} Pr(SR) = \\frac {\\exp(-1.5)}{\\exp(-0.5) + \\exp(-1.5) + \\exp(-3.0)} = 0.254 \\tag{4.14} \\end{equation}\\] \\[\\begin{equation} Pr(TR) = \\frac {\\exp(-3.0)}{\\exp(-0.5) + \\exp(-1.5) + \\exp(-3.0)} = 0.057 \\tag{4.15} \\end{equation}\\] Similarly, if the utility of each alternative is increased by one, the probabilities are: \\[\\begin{equation} Pr(DA) = \\frac {\\exp(0.5)}{\\exp(0.5) + \\exp(-0.5) + \\exp(-2.0)} = 0.690 \\tag{4.16} \\end{equation}\\] \\[\\begin{equation} Pr(SR) = \\frac {\\exp(-0.5)}{\\exp(0.5) + \\exp(-0.5) + \\exp(-2.0)} = 0.254 \\tag{4.17} \\end{equation}\\] \\[\\begin{equation} Pr(TR) = \\frac {\\exp(-2.0)}{\\exp(0.5) + \\exp(-0.5) + \\exp(-2.0)} = 0.057 \\tag{4.18} \\end{equation}\\] As expected, the choice probabilities are identical to those obtained before the addition of the constant utility to each mode. The calculations supporting this comparison are shown in Table 4.3 and Table 4.4. Table 4.3 shows the computation of the choice probabilities based on the initial set of modal utilities and Table 4.4 shows the same computation after each of the utilities is increased by one.4 Table 4.3: Numerical Example Illustrating Equivalent Difference Property: Probability of Each Alternative Before Adding Delta Utility Alternative Expression Value Exponent Probability Drive Alone -0.50 -0.5 0.6065307 0.6896721 Shared Ride -1.50 -1.5 0.2231302 0.2537162 Transit -3.00 -3.0 0.0497871 0.0566117 Total NA 0.8794479 1.0000000 where the sum of the exponent variable is equal to 0.879. Table 4.4: Numerical Example Illustrating Equivalent Difference Property: Probability of Each Alternative After Adding Delta (=1.0) Utility Alternative Expression Value Exponent Probability Drive Alone -0.50 + 1.00 0.5 1.6487213 0.6896721 Shared Ride -1.50 + 1.00 -0.5 0.6065307 0.2537162 Transit -3.00 + 1.00 -2.0 0.1353353 0.0566117 Total NA 2.3905872 1.0000000 Where the sum of the exponent variable is equal to 2.391 The expression for the probability equation of the logit model (equation 4.9) can also be presented in a different form which makes the equivalent difference property more apparent. For the drive alone alternative, this expression can be obtained by multiplying the numerator and denominator of the standard probability expression by (-VDA) as shown in the following equations. \\[\\begin{equation} \\begin{split} Pr(DA) &amp;= \\frac{\\exp(V_{DA})}{\\exp(V_{DA}) + \\exp(V_{SR}) + \\exp(V_{TR})} \\times \\frac {\\exp(-V_{DA})}{\\exp(-V_{DA})}\\\\ &amp;= \\frac {\\exp(V_{DA})\\times \\exp(-V_{DA})}{[\\exp(V_{DA}) + \\exp(V_{SR}) + \\exp(V_{TR})] \\times \\exp(-V_{DA})}\\\\ &amp;= \\frac {\\exp(0)}{\\exp(0) + \\exp(V_{SR}-V_{DA}) + \\exp(V_{TR}-V_{DA})} \\end{split} \\tag{4.19} \\end{equation}\\] which simplifies to: \\[\\begin{equation} Pr(i) = \\frac{1}{\\exp(0) + \\exp(V_{SR}-V_{DA}) + \\exp(V_{TR}-V_{DA})} \\tag{4.20} \\end{equation}\\] This formulation explicitly shows that the probability of the drive alone alternative is a function of the differences in systematic utility between the drive alone alternative and each other alternative. This can be applied to the general case for alternative \\(i\\) which can be represented in terms of the pairwise difference in its utility and the utility of each of the other alternatives by the following equation: \\[\\begin{equation} Pr(i) = \\frac{1}{1 + \\sum_{j \\ne i}\\exp(V_j - V_i)} \\qquad \\forall i \\in J \\tag{4.21} \\end{equation}\\] 4.1.2.1 Implication of Constant Differences for Alternative Specific Constants and Variables The constant difference property of logit models has an important implication for the specification of the utilities of the alternatives. Recall that the systematic portion of the utility of an individual, ‘\\(t\\)’, and alternative ‘\\(i\\)’ is the sum of decision-maker related bias, mode attribute related utility, and interactions between these. That is: \\[\\begin{equation} V_{DA} = V_{DA}(S_t) + V(X_{DA}) + V(S_t,X_{DA}) \\tag{4.22} \\end{equation}\\] \\[\\begin{equation} V_{SR} = V_{SR}(S_t) + V(X_{SR}) + V(S_t,X_{SR}) \\tag{4.23} \\end{equation}\\] \\[\\begin{equation} V_{TR} = V_{TR}(S_t) + V(X_{TR}) + V(S_t,X_{TR}) \\tag{4.24} \\end{equation}\\] Each term on the right hand side of each equation can be replaced by an explicit function of the relevant variables. For example, if the decision-maker preferences are a function of income, attribute based utility is a function of travel time and there are no interaction terms, the utility function becomes: \\[\\begin{equation} V_{DA} = \\beta_{DA,0} + \\beta_{DA,1} \\times Income_t + \\gamma \\times TT_{DA} \\tag{4.25} \\end{equation}\\] \\[\\begin{equation} V_{SR} = \\beta_{SR,0} + \\beta_{SR,1} \\times Income_t + \\gamma \\times TT_{SR} \\tag{4.26} \\end{equation}\\] \\[\\begin{equation} V_{TR} = \\beta_{TR,0} + \\beta_{TR,1} \\times Income_t + \\gamma \\times TT_{TR} \\tag{4.27} \\end{equation}\\] and the differences between pairs of alternatives for prediction of DA probability become: \\[\\begin{equation} \\begin{split} V_{SR} - V_{DA} = (\\beta_{SR,0} - \\beta_{DA,0}) + \\beta_{SR,1} - \\beta_{DA,1})\\\\ \\times Income_t + \\gamma \\times (TT_{SR} - TT_{DA}) \\end{split} \\tag{4.28} \\end{equation}\\] \\[\\begin{equation} \\begin{split} V_{TR} - V_{DA} = (\\beta_{TR,0} - \\beta_{DA,0}) + \\beta_{TR,1} - \\beta_{DA,1})\\\\ \\times Income_t + \\gamma \\times (TT_{TR} - TT_{TA}) \\end{split} \\tag{4.29} \\end{equation}\\] It is not possible to estimate all of the constants; \\(\\beta_{DA,0}\\), \\(\\beta_{SR,0}\\) and \\(\\beta_{TR,0}\\); and all of the income parameters; \\(\\beta_{DA,1}\\), \\(\\beta_{SR,1}\\) and \\(\\beta_{TR,1}\\); in these equations because adding any algebraic value to each of the constants or to each of the income parameters does not cause any change in the probabilities of any of the alternatives. This phenomenon is common to all utility-based choice models and follows directly from the equivalent differences property discussed above. The solution to this problem is to place a single constraint on each set of parameters; in this case, the constants and the income parameters. Any constraint can be adopted for each set of parameters; however, the simplest and most widely used is to set the preference related parameters for one alternative, called the base or reference alternative, to zero and to re-interpret the remaining parameters to represent preference differences relative to the base alternative. The selection of the reference alternative is arbitrary and does not affect the overall quality or interpretation of the model; however, the equations and the estimation results will appear to be different. For example, if we set TRansit as the reference alternative by setting \\(\\beta_{TR,0}\\) and \\(\\beta_{TR,1}\\) equal to zero, the utility functions become: \\[\\begin{equation} V_{DA,t} = \\beta_{DA-TR,0} + \\beta_{DA-TR,1} \\times Inc_t + \\gamma \\times TT_{DA} \\tag{4.30} \\end{equation}\\] \\[\\begin{equation} V_{SR,t} = \\beta_{SR-TR,0} + \\beta_{SR-TR,1} \\times Inc_t + \\gamma \\times TT_{SR} \\tag{4.31} \\end{equation}\\] \\[\\begin{equation} V_{TR,t} = \\qquad \\qquad \\qquad 0 \\qquad \\qquad \\qquad + \\gamma \\times TT_{TR} \\tag{4.32} \\end{equation}\\] where the modified notation for the remaining constants and income parameters is used to emphasize that these parameters are ‘relative to the TRansit alternative.’ Alternatively, if we select Drive Alone as the reference alternative, we obtain: \\[\\begin{equation} V_{DA,t} = \\qquad \\qquad \\qquad 0 \\qquad \\qquad \\qquad + \\gamma \\times TT_{DA} \\tag{4.33} \\end{equation}\\] \\[\\begin{equation} V_{SR,t} = \\beta_{SR-DA,0} + \\beta_{SR-DA,1} \\times Inc_t + \\gamma \\times TT_{SR} \\tag{4.34} \\end{equation}\\] \\[\\begin{equation} V_{TR,t} = \\beta_{TR-DA,0} + \\beta_{TR-DA,1} \\times Inc_t + \\gamma \\times TT_{TR} \\tag{4.35} \\end{equation}\\] where the constants and income parameters are relative to the Drive Alone alternative. These two models are equivalent as shown in Table ?? and Table ?? which correspond to the TRansit reference and Drive Alone reference examples, respectively, for an individual from a household with $50,000 annual income and facing travel times of 30, 35 and 50 minutes for Drive Alone, Shared Ride and TRansit, respectively. utility_table( c(&quot;Drive Alone&quot; = &quot;1.1 + 0.008 * 50 - 0.02 * 30&quot;, &quot;Shared Ride&quot; = &quot;0.8 + 0.006 * 50 - 0.02 * 35&quot;, &quot;Transit&quot; = &quot;0.0 + 0.000 * 50 - 0.02 * 50&quot;) ) %&gt;% kableExtra::kbl(caption = &quot;Utility and Probability calculation with TRansit as Base Alternative&quot;) %&gt;% kable_styling() %&gt;% add_header_above(c(&quot; &quot;=1, &quot;Utility&quot; = 2, &quot; &quot; = 2), align = &quot;center&quot;) Table 4.5: Utility and Probability calculation with TRansit as Base Alternative Utility Alternative Expression Value Exponent Probability Drive Alone 1.1 + 0.008 * 50 - 0.02 * 30 0.9 2.4596031 0.5694439 Shared Ride 0.8 + 0.006 * 50 - 0.02 * 35 0.4 1.4918247 0.3453852 Transit 0.0 + 0.000 * 50 - 0.02 * 50 -1.0 0.3678794 0.0851709 Total NA 4.3193072 1.0000000 where the sum of the exponent variable equals 4.319. utility_table( c( &quot;Drive Alone&quot; = &quot;0.0 + 0.000 * 50 - 0.02 * 30&quot;, &quot;Shared Ride&quot; = &quot;-0.3 - 0.002 * 50 - 0.02 * 35&quot;, &quot;Transit&quot; = &quot;-1.1 - 0.008 * 50 - 0.02 * 50&quot;) ) %&gt;% kableExtra::kbl(caption = &quot;Utility and Probability calculation with TRansit as Base Alternative&quot;) %&gt;% kable_styling() %&gt;% add_header_above(c(&quot; &quot;=1, &quot;Utility&quot; = 2, &quot; &quot; = 2), align = &quot;center&quot;) Table 4.6: Utility and Probability calculation with TRansit as Base Alternative Utility Alternative Expression Value Exponent Probability Drive Alone 0.0 + 0.000 * 50 - 0.02 * 30 -0.6 0.5488116 0.5694439 Shared Ride -0.3 - 0.002 * 50 - 0.02 * 35 -1.1 0.3328711 0.3453852 Transit -1.1 - 0.008 * 50 - 0.02 * 50 -2.5 0.0820850 0.0851709 Total NA 0.9637677 1.0000000 where the sum of the exponent variable equals 0.964. As expected, the resultant probabilities are identical in both cases. Table 4 7 shows that the differences in the alternative specific constants and income parameters between alternatives are the same for the TRansit base case and the Drive Alone base case. tibble( &quot;Alternative&quot;= c(&quot;Drive Alone&quot;, &quot;Shared Ride&quot;, &quot;Transit&quot;), &quot;Constant&quot; = c(&quot;1.1&quot;,&quot;0.8&quot;,&quot;0.0&quot;), &quot;Income&quot; = c(&quot;0.008&quot;, &quot;0.006&quot;, &quot;0.000&quot;), &quot;Constant &quot; = c(&quot;-1.1&quot;,&quot;-1.1&quot;,&quot;-1.1&quot;), &quot;Income &quot; = c(&quot;-0.008&quot;, &quot;-0.008&quot;, &quot;-0.008&quot;), &quot;Constant &quot; = c(&quot;0.0&quot;,&quot;-0.3&quot;,&quot;-1.1&quot;), &quot;Income &quot; = c(&quot;0.000&quot;, &quot;-0.002&quot;, &quot;-0.008&quot;)) %&gt;% kbl(caption = &quot;Changes in Alternative Specific Constants and Income Parameters&quot;) %&gt;% kable_styling() %&gt;% add_header_above(c(&quot; &quot; = 1, &quot;TRansit as Base Alternative&quot;= 2, &quot;Change in Parameters&quot; = 2, &quot;Drive Alone as Base Alternative&quot; = 2), align = &quot;center&quot;) Table 4.7: Changes in Alternative Specific Constants and Income Parameters TRansit as Base Alternative Change in Parameters Drive Alone as Base Alternative Alternative Constant Income Constant Income Constant Income Drive Alone 1.1 0.008 -1.1 -0.008 0.0 0.000 Shared Ride 0.8 0.006 -1.1 -0.008 -0.3 -0.002 Transit 0.0 0.000 -1.1 -0.008 -1.1 -0.008 4.2 Independence of Irrelevant Alternatives Property One of the most widely discussed aspects of the multinomial logit model is its independence from irrelevant alternatives (IIA) property. The IIA property states that for any individual, the ratio of the probabilities of choosing two alternatives is independent of the presence or attributes of any other alternative. The premise is that other alternatives are irrelevant to the decision of choosing between the two alternatives in the pair. To illustrate this, consider a multinomial logit model for the choice among three intercity travel modes – automobile, rail, and bus. The probability of choosing automobile, rail and bus are: \\[\\begin{equation} Pr(Auto) = \\frac{\\exp(V_{Auto})}{\\exp(V_{Auto})+\\exp(V_{Bus})+\\exp(V_{Rail})} \\tag{4.36} \\end{equation}\\] \\[\\begin{equation} Pr(Bus) = \\frac{\\exp(V_{Bus})}{\\exp(V_{Auto})+\\exp(V_{Bus})+\\exp(V_{Rail})} \\tag{4.37} \\end{equation}\\] \\[\\begin{equation} Pr(Rail) = \\frac{\\exp(V_{Rail})}{\\exp(V_{Auto})+\\exp(V_{Bus})+\\exp(V_{Rail})} \\tag{4.38} \\end{equation}\\] The ratios of each pair of probabilities are: \\[\\begin{equation} \\frac{Pr(Auto)}{Pr(Bus)} = \\frac{\\exp(V_{Auto})}{\\exp(V_{Bus})} = \\exp(V_{Auto} - V_{Bus}) \\tag{4.39} \\end{equation}\\] \\[\\begin{equation} \\frac{Pr(Auto)}{Pr(Rail)} = \\frac{\\exp(V_{Auto})}{\\exp(V_{Rail})} = \\exp(V_{Auto} - V_{Rail}) \\tag{4.40} \\end{equation}\\] \\[\\begin{equation} \\frac{Pr(Bus)}{Pr(Rail)} = \\frac{\\exp(V_{Bus})}{\\exp(V_{Rail})} = \\exp(V_{Bus} - V_{Rail}) \\tag{4.41} \\end{equation}\\] The ratios of probabilities for each pair of alternatives depend only on the attributes of those alternatives and not on the attributes of the third alternative and would remain the same regardless of whether that third alternative is available or not. This formulation can be generalized to any pair of alternatives by: \\[\\begin{equation} \\frac{Pr(i)}{Pr(k)} = \\frac{\\exp(V_i)}{\\exp(V_k)} = \\exp(V_i - V_k) \\tag{4.42} \\end{equation}\\] which, as before, is independent of the number or attributes of other alternatives in the choice set. The IIA property has some important ramifications in the formulation, estimation and use of multinomial logit models. The independence of irrelevant alternatives property allows the addition or removal of an alternative from the choice set without affecting the structure or parameters of the model. The flexibility of applying the model to cases with different choice sets has a number of advantages. First, the model can be estimated and applied in cases where different members of the population (and sample) face different sets of alternatives. For example, in the case of intercity mode choice, individuals traveling between some city pairs may not have air service and/or rail service. Second, this property simplifies the estimation of the parameters in the multinomial logit model (as will be discussed later). Third, this property is advantageous when applying a model to the prediction of choice probabilities for a new alternative. On the other hand, the IIA property may not properly reflect the behavioral relationships among groups of alternatives. That is, other alternatives may not be irrelevant to the ratio of probabilities between a pair of alternatives. In some cases, this will result in erroneous predictions of choice probabilities. An extreme example of this problem is the classic “red bus/blue bus paradox.” 4.2.1 The Red Bus/Blue Bus Paradox Consider the case of a commuter who has a choice of going to work by auto or taking a blue bus. Assume that the attributes of the auto and the blue bus are such that the probability of choosing auto is two-thirds and blue bus is one-third so the ratio of their choice probabilities is 2:1. Now suppose that a competing bus operator introduces red bus service (the bus is painted red, rather than blue) on the same route, operating the same vehicle type, using the same schedule and serving the same stops as the blue bus service. Thus, the only difference between the red and blue bus services is the color of the buses. The most reasonable expectation, in this case, is that the same share of people will choose auto and bus and that the bus riders will split equally between the red and blue bus services. That is, the addition of the red bus to the commuters’ choice set should have no, or very little, effect on the share of commuters choosing auto since this change does not affect the relative quality of drive alone and bus. Therefore, we expect choice probabilities following the initiation of red bus service to be auto, two-thirds; blue bus, one-sixth and red bus, one-sixth. However, due to the IIA property, the multinomial logit model will maintain the relative probability of auto and blue bus as 2:1. If we assume that people are indifferent to color of their transit vehicle, the two bus services will have the same representative utility and consequently, their relative probabilities will be 1:1 and the share probabilities for the three alternatives will be: Pr(Auto) = ½, Pr(Blue Bus) = 1/4, and Pr(Red Bus) = 1/4. That is, the probability (share) of people choosing auto will decline from two-thirds to one half as a result of introducing an alternative which is identical to an existing alternative5. The red bus/blue bus paradox provides an important illustration of the possible consequences of the IIA property. Although this is an extreme case; the IIA property can be a problem in other, less extreme cases. 4.3 Example: Prediction with Multinomial Logit Model We illustrate the application of multinomial logit models with different specifications in the context of mode choice analysis. Consider a commute trip by an individual who has three available modes in the choice set: drive alone, carpool, and bus. The examples in this section illustrate the manner in which different utility specifications and the estimated parameters associated with them are used to predict choice probabilities based on characteristics of the traveler (decision-maker) and attributes of the alternatives. These examples progress from the simplest models to moderately complex models. Example 1 – Constants Only Model The simplest specification of the multinomial logit model is the ‘constants only’ model, in which the utility of each alternative has a fixed value for all decision-makers. Typically, the alternative specific constants are considered to represent the average effect of all factors that influence the choice but are not included in the utility specification. For example, factors such as comfort, safety, privacy and reliability may be excluded due to the difficulty associated with their measurement. In the constants only model, it is implicitly assumed that the constants reflect the average effects of all the variables affecting the choice decision, since no variables are included explicitly in the utility specification. If these constants are 0.0, -1.6 and -1.8 for drive alone, shared ride and transit, respectively, the probability calculation is as shown in Table 4.8. Table 4.8: MNL Properties for Constants Only Model Utility Alternative Expression Value Exponent Probability Drive Alone 0.0 0.0 1.0000000 0.7314243 Shared Ride -1.60 -1.6 0.2018965 0.1476720 Transit -1.80 -1.8 0.1652989 0.1209036 Total NA 1.3671954 1.0000000 As expected, Drive Alone has the highest probability, followed by Shared Ride, and TRansit. Example 2 – Including Mode Related Variables - Travel Time and Travel Cost Two key attributes that influence choice of mode are travel time and travel cost. We include these variables in the deterministic component of the utility function of each mode with the parameter for time (in minutes) equal to -0.045 and for cost (in cents) equal to -0.004 for all three modes, Table 4.9. This implies that a minute of travel time (or a cent of cost) has the same marginal disutility regardless of the mode; such variables are referred to as generic variables. The negative signs of the travel time and travel cost coefficients imply that the utility of a mode and the probability that it will be chosen decreases as the travel time or travel cost of that mode increases. Positive coefficients would be inconsistent with our understanding of travel behavior and therefore any specification which results in a positive sign for travel time or travel cost should be rejected. Such counter-intuitive results are most likely due to an incorrect or inadequate model specification; however, it is possible that the data from any particular sample leads to such counter-intuitive results. The inclusion of travel time and travel cost variables induces a change in the alternative specific constants, to -1.865 for shared ride and -0.650 for transit, as the effect of excluding these time and cost variables is removed from the constants. Such changes in alternative specific constants, as a result of the introduction of new variables or the elimination of included variables preserve the sample shares6 and are expected. To illustrate the application of the multinomial logit model for the above utility equation, we assume travel time and travel cost values as follows: Mode Travel Time Travel Cost Drive Alone 25 minutes $1.75 Shared Ride 28 minutes $0.75 TRansit 55 minutes $1.25 The utilities and probabilities are calculated as shown in Table 4.9. utility_table( c(&quot;Drive Alone&quot; = &quot;-0.045*25-0.004*175&quot;, &quot;Shared Ride&quot; = &quot;-1.865-0.045*28-0.004*75&quot;, &quot;Transit&quot; = &quot;-0.650-0.045*55-0.004*125&quot;) ) %&gt;% kbl(caption = &quot;MNL Probabilities for Time and Cost Model&quot;) %&gt;% kable_styling() %&gt;% add_header_above(c(&quot; &quot; = 1, &quot;Utility&quot;= 2, &quot; &quot; = 2), align = &quot;center&quot;) Table 4.9: MNL Probabilities for Time and Cost Model Utility Alternative Expression Value Exponent Probability Drive Alone -0.04525-0.004175 -1.825 0.1612176 0.7314243 Shared Ride -1.865-0.04528-0.00475 -3.425 0.0325493 0.1476720 Transit -0.650-0.04555-0.004125 -3.625 0.0266491 0.1209036 Total NA 0.2204160 1.0000000 This specification can be refined further by decomposing travel time into its two major components: (1) in-vehicle travel time, and (2) out-of-vehicle travel time. In-vehicle time (IVT) is defined as the time spent inside the vehicle, and out-of-vehicle time (OVT) is the time not spent inside the vehicle (including access time, waiting time, and egress time). There is an abundance of empirical evidence that travelers are much more sensitive to out-of-vehicle time than to in-vehicle time and therefore a minute of out-of-vehicle time will generate a higher disutility than a minute of in-vehicle time. This will be reflected in the modal utilities by a larger negative coefficient on out-of-vehicle time than on in-vehicle time. Introduction of this refinement will usually result in a less negative parameter for in vehicle time and a more negative parameter for out of vehicle time than for total time; say -0.031 and -0.062, respectively. If the travel times are split as follows: Mode IVT OVT Travel Cost Drive Alone 21 minutes 4 minutes $1.75 Shared Ride 23 minutes 5 minutes $0.75 Bus 25 minutes 30 minutes $1.25 the new systematic utilities and choice probabilities are as computed in Table 4.10: utility_table( c(&quot;Drive Alone&quot; = &quot;-0.031*21-0.062*4-0.004*175&quot;, &quot;Shared Ride&quot; = &quot;-1.90-0.031*23-0.062*5-0.004*75&quot;, &quot;Transit&quot; = &quot;-0.80-0.031*25-0.062*30-0.004*125&quot;) ) %&gt;% kbl(caption = &quot;MNL Probabilities for Time and Cost Model&quot;) %&gt;% kable_styling() %&gt;% add_header_above(c(&quot; &quot; = 1, &quot;Utility&quot;= 2, &quot; &quot; = 2), align = &quot;center&quot;) Table 4.10: MNL Probabilities for Time and Cost Model Utility Alternative Expression Value Exponent Probability Drive Alone -0.03121-0.0624-0.004*175 -1.599 0.2020985 0.7729036 Shared Ride -1.90-0.03123-0.0625-0.004*75 -3.223 0.0398354 0.1523460 Transit -0.80-0.03125-0.06230-0.004*125 -3.935 0.0195457 0.0747504 Total NA 0.2614796 1.0000000 Example 3 – Including Decision-Maker Related Biases - Income The preceding examples do not include any characteristics of the traveler in the modal utilities. However, we know that choice probabilities of the available modes also depend on characteristics of the traveler, such as his/her income. Economic theory and empirical evidence suggests that higher income travelers are less likely to choose transit than drive alone or carpool. We can incorporate this behavior in the model by including an alternative specific income variable in the utility of up to two of the alternatives; in this case, we include income in the transit alternative with a negative coefficient. That is, everything else held constant, the utility of transit decreases as the income of the traveler increases. Consequently, a higher income traveler will have a lower probability of choosing transit than a lower income traveler. The absence of an alternative specific parameter for the carpool alternative implies that the choice of carpool, relative to drive alone, is unaffected by a traveler’s income. The alternative specific constant of the transit utility changes substantially from the preceding example as it no longer reflects the average effect of excluding income from the transit utility specification. The calculation of utilities and probabilities for this model for a person from a household with $50,000 annual income is shown in 4.11. utility_table( c(&quot;Drive Alone&quot; = &quot; -0.031*21-0.062*4-0.004*175&quot;, &quot;Shared Ride&quot; = &quot;-1.90-0.031*23-0.062*5-0.004*75&quot;, &quot;Transit&quot; = &quot;-0.50-0.031*25-0.062*30-0.004*125-0.0087*50&quot;) ) %&gt;% kbl(caption = &quot;MNL Probabilities for In and Out of Vehicle Time, Cost and Income Model&quot;) %&gt;% kable_styling() %&gt;% add_header_above(c(&quot; &quot; = 1, &quot;Utility&quot;= 2, &quot; &quot; = 2), align = &quot;center&quot;) Table 4.11: MNL Probabilities for In and Out of Vehicle Time, Cost and Income Model Utility Alternative Expression Value Exponent Probability Drive Alone -0.03121-0.0624-0.004*175 -1.599 0.2020985 0.7802692 Shared Ride -1.90-0.03123-0.0625-0.004*75 -3.223 0.0398354 0.1537978 Transit -0.50-0.03125-0.06230-0.004125-0.008750 -4.070 0.0170774 0.0659330 Total NA 0.2590113 1.0000000 The probability of choosing transit is smaller for this traveler than would have been predicted using the model reported in the preceding example. This model will give decreasing transit probabilities for higher income travelers and increasing transit probabilities for lower income travelers. That is, the lower the traveler’s income, the greater his/her probability of choosing the least expensive mode of travel (transit), an intuitive and reasonable result. Example 4 – Interaction of Mode Attributes and Decision-Maker Related Biases An alternative method of including income in the utility specification is to use income as a deflator of cost by forming a variable by dividing cost by income. This formulation reflects the rationale that cost becomes a less important factor in the choice of a travel mode as the income of the traveler increases. The revised utility functions and calculations are shown in Table 4.12 using the values for the modal attributes and income as used in preceding example. utility_table( c(&quot;Drive Alone&quot; = &quot; -0.031*21-0.062*4-0.153*(175/50) &quot;, &quot;Shared Ride&quot; = &quot; -1.90-0.031*23-0.062*5-0.153*(75/50) &quot;, &quot;Transit&quot; = &quot;-0.45-0.031*25-0.062*30-0.153*(125/50)&quot;) ) %&gt;% kbl(caption = &quot;MNL Probabilities for In and Out of Vehicle Time, Cost/Income Model&quot;) %&gt;% kable_styling() %&gt;% add_header_above(c(&quot; &quot; = 1, &quot;Utility&quot;= 2, &quot; &quot; = 2), align = &quot;center&quot;) Table 4.12: MNL Probabilities for In and Out of Vehicle Time, Cost/Income Model Utility Alternative Expression Value Exponent Probability Drive Alone -0.03121-0.0624-0.153*(175/50) -1.4345 0.2382345 0.7631451 Shared Ride -1.90-0.03123-0.0625-0.153*(75/50) -3.1525 0.0427451 0.1369270 Transit -0.45-0.03125-0.06230-0.153*(125/50) -3.4675 0.0311949 0.0999278 Total NA 0.3121745 1.0000000 This specification of income in the utility function also results in lower income travelers predicted to have higher probability of choosing transit; it also suggests that such travelers will increase their probability of choosing carpool, the least expensive mode. The reader should compute the probabilities for different income values and verify the response pattern. 4.4 Measures of Response to Changes in Attributes of Alternatives Choice probabilities in logit models are a function of the values of the attributes that define the utility of the alternatives; therefore, it is useful to know the extent to which the probabilities change in response to changes in the value of those attributes. For example, in a traveler’s mode choice decision, an important question is to what extent the probability of choosing a mode (rail, for example) will decrease/increase, if the fares of that mode are increased by a certain amount. Similarly, a transit agency may want to know the gain in ridership that is likely to occur in response to service improvements (increased frequency). This section describes various aspects of understanding and quantifying the response to changes in attributes of alternatives. 4.4.1 Derivatives of Choice Probabilities One measure for evaluating the response to changes is to calculate the derivatives of the choice probabilities of each alternative with respect to the variable in question. Usually, one is concerned about the change in probability of an alternative, \\(P_i\\), with respect to the change in attributes of that alternative \\(X_i\\). This measure, the direct derivative, is computed by differentiating \\(P_i\\) with respect to \\(X_{ik}\\), the \\(k^{th}\\) attribute of alternative \\(i\\). The mathematical expression for the direct derivative of \\(P_i\\) with respect to \\(X_{ik}\\) is: \\[\\begin{equation} \\displaystyle \\frac{\\partial P_{i}}{\\partial X_{ik}} = \\displaystyle \\frac{\\partial V_{i}}{\\partial X_{ik}} \\times (P_{i}) \\times (1-P_{i}) \\tag{4.43} \\end{equation}\\] where \\(V_i\\) is the utility of the alternative.7 Typically the utility function is specified to be linear in parameters; that is: \\[\\begin{equation} V_{i} = \\beta_{0} + \\beta_{1}X_{1i} + \\beta_{2}X_{2i} + \\cdots + \\beta_{k}X_{ki} + \\cdots + \\beta_{K}X_{Ki} \\tag{4.44} \\end{equation}\\] In this case, the expression for the direct derivative of \\(P_i\\) with respect to \\(X_{ik}\\) reduces to: \\[\\begin{equation} \\displaystyle \\frac{\\partial P_{i}}{\\partial X_{ki}} = \\beta_{k} \\times (P_{i}) \\times (1-P_{i}) \\tag{4.45} \\end{equation}\\] where \\(\\beta_{k}\\) is the coefficient of attribute \\(k\\). The value of the derivative is largest at \\(P_{i} = \\frac{1}{2}\\) and becomes smaller as \\(P_{i}\\) approaches zero or one. This implies that the magnitude of the response to a change in an attribute will be greatest when the choice probability for the alternative under consideration is 0.5 and this response diminishes as the probability approaches zero or one. The direct derivative is simply the slope of the logit model probability curve illustrated in Figure 4.4 and that its mathematical properties are consistent with the qualitative discussion of the S-shape of the logit probability curve in section 4.1.1. The sign of the derivative is the same as the sign of the parameter describing the impact of \\(X_{ik}\\) in the utility of alternative \\(i\\). Thus, an increase in \\(X_{ik}\\) will increase (decrease) \\(P_{i}\\) if \\(\\beta_{ik}\\) is positive (negative). Often it is important to understand how the choice probability of other alternatives changes in response to a given change in the attribute level of the action alternative. This measure, termed the \\(cross\\) \\(derivative\\), is obtained by computing the derivative of the choice probability of an alternative,\\(P_{j}\\) , with respect to the attribute of the changed alternative, \\(X_{ik}\\). This \\(cross\\) \\(derivative\\) for linear utility functions is:8 \\[\\begin{equation} \\displaystyle \\frac{\\partial P_{i}}{\\partial X_{ki}} = \\beta_{k} \\times (P_{i}) \\times (1-P_{j}) \\tag{4.46} \\end{equation}\\] Often it is important to understand how the choice probability of other alternatives changes in response to a given change in the attribute level of the action alternative. This measure, termed the cross derivative, is obtained by computing the derivative of the choice probability of an alternative, \\(P_j\\), with respect to the attribute of the changed alternative, \\(X_{ik}\\). This cross derivative for linear utility functions is: \\[\\begin{equation} \\displaystyle \\frac{\\partial P_{j}}{\\partial X_{ik}} = \\beta_{k} \\times (P_{i}) \\times (P_{j}) \\forall_{i} \\ne j \\tag{4.47} \\end{equation}\\] where \\(\\beta_{jk}\\) is the coefficient of the \\(k^{th}\\) attribute of alternative \\(j\\), \\(P_{i}\\) is the probability of alternative \\(i\\), and \\(P_{j}\\) is the probability of alternative \\(j\\). In this case, the sign of the derivative is opposite to the sign of the parameter describing the impact of \\(X_{ik}\\) on the utility of alternative \\(i\\). Thus an increase in \\(X_{ik}\\) will decrease (increase) the probability of choosing alternative, \\(P_{i}\\), if the parameter \\(\\beta_{k}\\) is positive (negative). In this case, the sign of the derivative is opposite to the sign of the parameter describing the impact of \\(X_{ik}\\) on the utility of alternative \\(i\\). Thus an increase in \\(X_{ik}\\) will decrease (increase) the probability of choosing alternative, \\(P_j\\), if the parameter \\(\\beta_k\\) is positive (negative). It is useful to recognize that the sum of the derivatives over all the alternatives must be equal to zero. That is, \\[\\begin{align} \\sum_{\\forall_{j}}\\frac{\\partial P_{j}}{\\partial X_{ik}}&amp;= \\frac{\\partial P_{j}}{\\partial X_{ik}} + \\sum_{\\forall_{j \\ne i}}\\frac{\\partial P_{j}}{\\partial X_{ik}}\\\\ &amp;= \\beta_{k}P_{i}(1-P_{i}) - \\sum_{\\forall_{j \\ne i}}\\beta_{k}P_{i}P_{j}\\\\ &amp;= \\beta_{k}P_{i}(1-P_{i}) - \\beta_{k}P_{i}\\sum_{\\forall_{j \\ne i}}P_{j}\\\\ &amp;= \\beta_{k}P_{i}(1-P_{i}) - \\beta_{k}P_{i}(1-P_{i})\\\\ &amp;= 0 \\tag{4.48} \\end{align}\\] This is as expected. Since the sum of all probabilities is fixed at one, the sum of the derivatives of the probability due to a change in any attribute of any alternative must be equal to zero. 4.4.2 Elasticities of Choice Probabilities Elasticity is another measure that is used to quantify the extent to which the choice probabilities of each alternative will change in response to the changes in the value of an attribute. In general, elasticity is defined as the percentage change in the response variable with respect to a one percent change in an explanatory variable. In the context of logit models, the response variable is the choice probability of an alternative, such as \\(P_i\\), and the explanatory variable is the attribute \\(X_{ik}\\). Elasticities are different from derivatives in that elasticities are normalized by the variable units. To clearly illustrate the concept of elasticity, let us consider that \\(P_{i1}\\) and \\(P_{i2}\\) are choice probabilities of an alternative \\(i\\) at attribute levels \\(X_{i1}\\) and \\(X_{i2}\\), respectively. In this case, the elasticity is the proportional change in the probability divided by the proportional change in the attribute under consideration: \\[\\begin{equation} \\text{Elasticity} = \\frac{\\text{Pct Change in Probability}}{\\text{Pct Change in Variable}} = \\frac{(P_{2}-P_{1})/P_{1}}{(X_{2}-X_{1})/X_{1}} = \\frac{\\Delta P/P_{1}}{\\Delta X/X_{1}} \\tag{4.49} \\end{equation}\\] There is some ambiguity in the computation of this elasticity measure in terms of whether it should be normalized using the original probability-attribute combination (\\(P_{i1}\\), \\(X_{i1}\\) ) or the new probability-attribute combination (\\(P_{i2}\\), \\(X_{i2}\\)). A compromise approach is to compute the elasticity relative to the mid-point of both sets of variables, yielding a measure called the arc elasticity. The expression for arc elasticity is: There is some ambiguity in the computation of this elasticity measure in terms of whether it should be normalized using the original probability-attribute combination (\\(P_{i1}\\), \\(X_{i1}\\)) or the new probability-attribute combination (\\(P_{i2}\\), \\(X_{i2}\\)). A compromise approach is to compute the elasticity relative to the mid-point of both sets of variables, yielding a measure called the arc elasticity. The expression for arc elasticity is: \\[\\begin{equation} \\displaystyle Arc Elasticity = \\frac{\\Bigg(\\frac{(P_{2}-P_{1})}{(P_{1}+P_{2})/2)}\\Bigg)}{\\Bigg(\\frac{(X_{2}-X_{1})}{(X_{1}+X_{2})/2)}\\Bigg)} = \\frac{\\Bigg(\\frac{(\\Delta P)}{(P_{1}+P_{2})/2)}\\Bigg)}{\\Bigg(\\frac{(\\Delta X)}{(X_{1}+X_{2})/2)}\\Bigg)} \\tag{4.50} \\end{equation}\\] Estimates of elasticity will differ depending on whether the normalization is at the start value, final value or mid-point values. This confusion can be avoided by computing elasticities for \\(\\underline{very\\ small}\\) changes. When the elasticity is computed for infinitesimally small changes, the elasticity obtained is termed the point elasticity. The expression for point elasticity is given as a function of the derivatives discussed earlier (section 4.4.1): \\[\\begin{equation} \\displaystyle \\eta_{X}^{P} = \\frac{\\Bigg(\\frac{\\partial P}{P}\\Bigg)}{\\Bigg(\\frac{\\partial X}{X}\\Bigg)} = \\Bigg(\\frac{\\partial P}{\\partial X}\\Bigg) \\times \\Bigg(\\frac{X}{P}\\Bigg) \\tag{4.51} \\end{equation}\\] Estimates of elasticity will differ depending on whether the normalization is at the start value, final value or mid-point values. This confusion can be avoided by computing elasticities for very small changes. When the elasticity is computed for infinitesimally small changes, the elasticity obtained is termed the point elasticity. The expression for point elasticity is given as a function of the derivatives discussed earlier (section 4.4.1): \\[\\begin{equation} \\displaystyle \\eta_{X_{ik}}^{P_{i}} = \\frac{\\Bigg(\\frac{\\partial P_{i}}{P}\\Bigg)}{\\Bigg(\\frac{\\partial X_{ik}}{X_{ik}}\\Bigg)} = \\Bigg(\\frac{\\partial P_{i}}{\\partial X_{ik}}\\Bigg) \\times \\Bigg(\\frac{X_{ik}}{P_{i}}\\Bigg) \\tag{4.52} \\end{equation}\\] We are interested in both direct- and cross-elasticities corresponding to the direct- and cross-derivatives discussed above. The direct elasticity measures the percent change in the choice probability of alternative, \\(P_i\\) with respect to a percent change in the attribute level (\\(X_{ik}\\)) of that alternative: We can substitute equation 4.45 into 4.51 to obtain the following expression for the direct elasticity \\[\\begin{equation} \\displaystyle \\eta_{X_{ik}}^{P_{i}} = \\beta_{k}P_{i}(1-P_{i})\\Bigg(\\frac{X_{ik}}{P_{i}}\\Bigg) = \\beta_{k}X_{ik}(1-P_{i}) \\tag{4.53} \\end{equation}\\] Thus, the direct elasticity is not only a function of the parameter value, \\(\\beta_{k}\\), for the attribute in the utility, but is also a function of the attribute level, \\(X_{ik}\\), at which the elasticity is being computed. Thus, the direct elasticity is not only a function of the parameter value, \\(\\beta_k\\), for the attribute in the utility, but is also a function of the attribute level, \\(X_{ik}\\), at which the elasticity is being computed. Similarly, the cross-elasticity is defined as the proportional change in the choice probability of an alternative (\\(P_j\\)) with respect to a proportional change in some attribute of another alternative (\\(X_{ik}\\)). The expression for cross elasticity in a multinomial logit model is given by: \\[\\begin{equation} \\displaystyle \\eta_{X_{ik}}^{P_{j}} = \\frac{\\Bigg(\\frac{\\partial P_{j}}{P_{j}}\\Bigg)}{\\Bigg(\\frac{\\partial X_{ik}}{X_{ik}}\\Bigg)} = \\Bigg(\\frac{\\partial P_{j}}{\\partial X_{ik}}\\Bigg) \\times \\Bigg(\\frac{X_{ik}}{P_{j}}\\Bigg) \\ \\forall j\\ne i \\tag{4.54} \\end{equation}\\] We substitute equation 4.46 into 4.53 to obtain the following expression for cross elasticity of logit model probabilities: \\[\\begin{equation} \\displaystyle \\eta_{X_{ik}}^{P_{i}} = (-\\beta_{k}P_{i}P_{j})\\Bigg(\\frac{X_{ik}}{P_{j}}\\Bigg) = -\\beta_{k}X_{ik}P_{i} \\tag{4.55} \\end{equation}\\] An important property of MNL models is that the cross-elasticities are the same for all the other alternatives in the choice set. This property of the multinomial logit model is another manifestation of the IIA property discussed in the previous section. The elasticity expressions derived above are based on the assumption that the independent variables for which the elasticities are being derived are continuous variables (e.g., travel time and travel cost). However, if the variable of interest is discrete in nature (e.g., number of automobiles in a household), it is not differentiable by definition. For this reason, derivatives can not be derived for ordinal or categorical variables. An alternative is to calculate the incremental change is each probability with respect to a one unit change in an ordered variable or a category shift for categorical variables and to use the differences to compute arc elasticities. 4.5 Measures of Responses to Changes in Decision Maker Characteristics Choice probabilities in logit models are also a function of the values of the characteristics of the decision maker (traveler). Therefore, it is equally useful to know the extent to which the probabilities of alternatives change in response to changes in the value of these characteristics. For example, in a traveler’s mode choice decision, an important question is to what extent the probability of choosing a mode will decrease/increase, if the income of the traveler changes by a certain amount. This section formulates both the derivatives and elasticity equations for evaluating such responses and thereby provides understanding and quantifies the response to changes in the characteristics of travelers. 4.5.1 Derivatives of Choice Probabilities Derivatives indicate the change in probability of each alternative in the choice set per unit change in a characteristic of the traveler. The analysis approach is similar to that employed in section 4.4. The important difference is that in section 4.4, we were assessing the impact of a change in probability of an alternative in response to a change in an attribute of a single alternative; either the same alternative (direct-derivative and direct-elasticity) or another alternative (cross-derivative and cross-elasticity). In the case of traveler characteristics, those characteristics may appear in alternative specific form in all alternatives (except for one reference alternative). Thus, we are considering what, in effect, becomes a combination of one direct response and multiple cross responses. Consider, for example, the probability of choosing alternative \\(i\\) in response to a change in income, specific to alternative \\(i\\). That is, \\[\\begin{equation} \\frac{\\partial P_i}{\\partial Inc_i} = (1 - P_i)P_i\\beta_{Inc_i} \\tag{4.56} \\end{equation}\\] However, since an identical change in income will occur for all alternatives in which income appears as an alternative specific variable, we consider the cross-derivative of the probability of choosing alternative \\(i\\) in response to a change in income, specific to alternative \\(j\\). That is, \\[\\begin{equation} \\frac{\\partial P_i}{\\partial Inc_j} = -P_iP_j\\beta_{Inc,_j} \\tag{4.57} \\end{equation}\\] The corresponding sum over all alternatives \\(i \\ne j\\) is \\[\\begin{equation} \\sum_{j\\ne i}\\frac{\\partial P_i}{\\partial Inc_j} = -P_i\\sum_{j \\ne i}P_j\\beta_{Inc,_j} \\tag{4.58} \\end{equation}\\] and the sum over all alternatives including \\(i\\) is \\[\\begin{equation} \\begin{split} \\frac{\\partial P_i}{\\partial Inc} = P_i(1-P_i)\\beta_{Inc,_i}-\\sum_{j\\ne i}P_iP_j\\beta_{Inc,_j}\\\\ = P_i\\beta_{Inc,_j} - \\sum_{\\forall j}P_iP_j\\beta_{Inc,_j}\\\\ = P_i[\\beta_{Inc,_i} - \\sum_{\\forall j}P_j\\beta_{Inc,_j}]\\\\ = P_i[\\beta_{Inc,_i} - \\overline{\\beta}_{Inc}]\\\\ \\end{split} \\tag{4.59} \\end{equation}\\] where \\(\\overline{\\beta}_{Inc}\\) is the probability weighted average of the alternative specific income parameters That is, the derivative of the probability with respect to a change in income is equal to the probability times the amount by which the income coefficient for that alternative exceeds the probability weighted average income coefficient over all alternatives9. It should be apparent that the sum over all alternatives of the income derivatives must be equal to one to ensure that the total probability over all alternatives is unchanged by any change in income. This can be shown by summing equation 4.58 over all alternatives in the choice set. 4.5.2 Elasticities of Choice Probabilities Elasticity is another measure that can be used to quantify the extent to which the choice probabilities are influenced by changes in a variable; in this case, a variable that describes the characteristics of the traveler. In this case, the elasticity of the probability of alternative \\(i\\) to a change in income is given by \\[\\begin{equation} \\eta_{Inc}^{P_i} = (\\beta_{Inc_i} - \\overline{\\beta}_{Inc}) \\times Inc \\tag{4.60} \\end{equation}\\] As before, the elasticity represents the proportional change in probability of an alternative to a proportional change in the explanatory variable. 4.6 Model Estimation: Concept and Method Logit model development consists of formulating model specifications and estimating numerical values of the parameters for the various attributes specified in each utility function by fitting the models to the observed choice data. The critical elements of this process become the selection of a preferred specification based on statistical measures and judgment. Under some circumstances, the model developer may impose constraints on the estimation to ensure desired relationships with respect to the relative value of different variables. 4.6.1 Graphical Representation of Model Estimation We illustrate the basic concepts of model estimation using a binary choice model with two variables and no constant. Consider that the only two modes available to a traveler are auto and bus and the deterministic component of the utility function for the two modes is defined as follows: \\[\\begin{equation} V_{Auto} = \\beta_1 \\times TravelTime_{Auto} + \\beta_{2} \\times TravelCost_{Auto} \\tag{4.61} \\end{equation}\\] \\[\\begin{equation} V_{Bus} = \\beta_1 \\times TravelTime_{Bus} + \\beta_{2} \\times TravelCost_{Bus} \\tag{4.62} \\end{equation}\\] Let us assume that in this example, bus has higher travel time and lower cost than car. For a traveler, the choice of travel mode will depend on his/her relative valuation of travel time and travel cost. A traveler who values time much more than cost will have a higher utility for car; whereas, a traveler who values time less than cost will have a higher utility for bus. This concept is illustrated in Figure 4.5 which shows the time and cost values for auto and bus iso-utility line10 for both types of travelers. When the iso-utility lines are steep enough to ensure that some iso-utility line is below bus and above car (case 1) implying a low value of time, bus will be the chosen mode. Conversely, if the iso-utility lines are flat enough to ensure that some iso-utility line is below car and above bus (case 2) implying a high value of time, car will be the chosen mode. The concept of iso-utility lines can be used to graphically describe the estimation of model parameters using observed choice data. This is illustrated in Figure 4.6 which shows the observed choice data for two travelers where each traveler has a choice between bus and car. The first traveler chooses bus (Bus 1) whereas the second traveler chooses car (Car 2). The objective is to find an iso-utility line with a slope that is steep enough to place Bus 1 above Car 1 and flat enough to place Bus 2 below Car 2. The figure shows that there many iso-utility lines with different slopes that satisfy the above conditions. However, even with only two observations, the range of the slopes of these lines is limited. The addition of more choice observation will further reduce the possible range of iso-utility lines. If all choosers are governed by the strict utility equations 4.60 and 4.61; additional observations will narrow the range of results to any satisfactory level of precision. However, as discussed previously, we expect that the analyst will not know all the variables that influence the traveler’s choice and/or will measure some variables differently than the user. Thus, it is unlikely that the observations can be separated by a single boundary. In this case, it becomes necessary to use an estimation method which scores different estimation results in terms of how well they identify the chosen alternatives. This is accomplished by using maximum likelihood estimation methods. The maximum likelihood method consists of finding model parameters which maximize the likelihood (posterior probability) of the observed choices conditional on the model. That is, to maximize the likelihood that the sample was generated from the model with the selected parameter values. 4.6.2 Maximum Likelihood Estimation Theory The procedure for maximum likelihood estimation involves two important steps: 1) developing a joint probability density function of the observed sample, called the likelihood function, and 2) estimating parameter values which maximize the likelihood function. The likelihood function for a sample of ‘T’ individuals, each with ‘J’ alternatives is defined as follows: \\[\\begin{equation} L(\\beta) = \\prod_{\\forall t \\in T} \\prod_{\\forall j \\in J}(P_{jt}(\\beta))^{\\delta_{jt}} \\tag{4.63} \\end{equation}\\] where \\(\\delta_{jt} = 1\\) is chosen indicator (\\(=1\\)if \\(j\\) is chosen by individual \\(t\\) and 0, otherwise) and \\(P_{jt}\\) is the probability that individual \\(t\\) chooses alternative \\(j\\). The values of the parameters which maximize the likelihood function are obtained by finding the first derivative of the likelihood function and equating it to zero. Since the log of a function yields the same maximum as the function and is more convenient to differentiate, we maximize the log-likelihood function instead of the likelihood function itself. The expressions for the log likelihood function and its first derivative are shown in equations (4.64) and (4.65) respectively: \\[\\begin{equation} LL(\\beta) = Log(L(\\beta)) = \\sum_{\\forall t \\in T} \\sum_{\\forall j \\in J} \\delta_{jt} \\times ln(P_{jt}(\\beta)) \\tag{4.64} \\end{equation}\\] \\[\\begin{equation} \\frac{\\partial (LL)}{\\partial \\beta_k} = \\sum_{\\forall t \\in T} \\sum_{\\forall j \\in J} \\delta_{jt} \\times \\frac{1}{P_{jt}} \\times \\frac{\\partial P_{jt}(\\beta)}{\\partial \\beta} \\qquad \\forall k \\tag{4.65} \\end{equation}\\]11 Further development of the derivative requires representation of the probability function, \\(P_{jt}\\), expanded from the version that appears in Equation 4.5 is \\[\\begin{equation} P_{jt}= \\frac{\\exp({X&#39;}_{jt}\\beta)}{\\sum_{j&#39;}\\exp({X&#39;}_{jt}\\beta)} \\tag{4.66} \\end{equation}\\] and the first derivative with respect to each element of \\(\\beta\\) is \\[\\begin{equation} \\frac{\\partial P_{jt}}{\\partial \\beta_k} = P_{jt}\\left({X&#39;}_{jkt}-\\sum_{j&#39;}P_{j&#39;t}X_{j&#39;kt}\\right) \\forall k \\tag{4.67} \\end{equation}\\]12 Substituting Equation (4.67) into Equation 4.64 gives \\[\\begin{equation} \\frac{\\partial (LL)}{\\partial \\beta_k} = \\sum_{\\forall t \\in T} \\sum_{\\forall j \\in J} \\delta_{jt} \\left({X&#39;}_{jt} - \\sum_{j&#39;t} P_{j&#39;t}X_{j&#39;t} \\right) \\\\ = \\sum_{\\forall t \\in T} \\sum_{\\forall j \\in J} (\\delta_{jt} - P_{j&#39;t}) {X&#39;}_{jt} \\forall k \\tag{4.68} \\end{equation}\\] for the derivative of the log-likelihood with respect to \\(\\beta_k\\). The maximum likelihood is obtained by setting Equation (4.68) equal to zero and solving for the best values of the parameter vector, \\(\\hat{\\beta}\\). We can be sure this is the solution for a maximum value provided that the second derivative is negative definite. In this case, the second derivative of the log-likelihood with respect to \\(\\beta\\) is \\[\\begin{equation} \\frac{\\partial^2 (LL)}{\\partial \\beta \\partial \\beta&#39;} = \\sum_{\\forall t \\in T} \\sum_{\\forall j \\in J} - P_{j&#39;t}({X&#39;}_{jt}-\\overline{X}_t)({X&#39;}_{jt}-\\overline{X}_t)&#39; \\tag{4.69} \\end{equation}\\] is negative definite for all values of \\(\\beta\\). Equations (4.68) and (4.69) are used to solve the maximum likelihood problem using a variety of available algorithms. In most practical problems, this involves significant computations and specialized computer programs to find the desired solution. The following example illustrates the application of maximum likelihood to estimate logit model parameters. 4.6.3 Example of Maximum Likelihood Estimation Suppose a logit model of binary choice between car and bus is to be estimated. For simplicity, let us assume the utility specification includes only the travel time variable and that the deterministic portion of the utility function for the two modes is defined as follows: \\[\\begin{equation} $\\displaystyle V_{Auto} = \\beta_{1} \\times Travel \\ Time_{Auto}$ \\tag{4.70} \\end{equation}\\] \\[\\begin{equation} $\\displaystyle V_{Bus} = \\beta_{1} \\times Travel \\ Time_{Bus}$ \\tag{4.71} \\end{equation}\\] Suppose that the estimation sample consists of observations of mode choice of only three individuals. The modal travel times and observed choice for each of the three individuals in the sample is as follows: Individual # Auto Travel Time Bus Travel Time Chosen Mode 1 30 minutes 50 minutes Car (mode 1) 2 20 minutes 10 minutes Car (mode 2) 3 40 minutes 30 minutes Bus (mode 2) According to the logit model, the probabilities for the observed mode for each individual are: \\[\\begin{align} \\text{Individual}_1 \\ (P_{11}) &amp;= \\frac{\\exp(30\\beta)}{\\exp(50\\beta)+\\exp(30\\beta)} = \\frac{1}{1+\\exp(20\\beta)} \\tag{4.72}\\\\ \\text{Individual}_2 (P_{12}) &amp;= \\frac{\\exp(20\\beta)}{\\exp(10\\beta)+\\exp(20\\beta)} = \\frac{1}{1+\\exp(-10\\beta)} \\tag{4.73}\\\\ \\text{Individual}_3 \\ (P_{23}) &amp;= \\frac{\\exp(30\\beta)}{\\exp(30\\beta)+\\exp(40\\beta)} = \\frac{1}{1+\\exp(10\\beta)} \\tag{4.74} \\end{align}\\] The log-likelihood expression for this sample will be as follows: \\[\\begin{align} LL &amp;= \\sum_{j=1,2}\\sum_{t=1,2,3}\\delta_{jt} \\times \\ln(P_{jt})\\\\ &amp;= 1 \\times \\ln(P_{11}) + 0 \\times \\ln(P_{21}) + 1 \\times \\ln(P_{12}) \\ldots \\\\ &amp;= \\ln(P_{11})+\\ln(P_{12})+\\ln(P_{23})\\\\ \\tag{4.75} \\end{align}\\] A maximum likelihood estimator finds the value of the parameter \\(\\beta\\) which maximizes the log-likelihood value. This solution is obtained by setting the first derivative of the log-likelihood function equal to zero, and solving for \\(\\hat{\\beta}\\). However, for this illustrative example, we can plot the graph for log-likelihood (or likelihood) as a function of \\(\\beta\\) to find the point where the maximum occurs. Figure 4.5 shows the graph of likelihood and log-likelihood as a function of \\(\\beta\\). It can be seen that the point where the maximum occurs is identical for both the likelihood and the log-likelihood functions, i.e., at \\(\\beta = -0.076\\). This value is called the maximum likelihood estimate of \\(\\beta\\). Practical applications of logit models include multiple parameters and many observations. Consequently, the maximum likelihood estimates for the parameters cannot be found graphically. Specialized software packages are available for this purpose. # calculate probabilities for example individuals demo_ps &lt;- function(beta){ v1a &lt;- beta * 30 v1t &lt;- beta * 50 p1 &lt;- exp(v1a) / (exp(v1t) + exp(v1a)) v2a &lt;- beta * 20 v2t &lt;- beta * 10 p2 &lt;- exp(v2a) / (exp(v2t) + exp(v2a)) v3a &lt;- beta * 40 v3t &lt;- beta * 30 p3 &lt;- exp(v3t) / (exp(v3t) + exp(v3a)) c(p1, p2, p3) } # calculate likelihood function demo_likelihood &lt;- function(beta) { ps &lt;- demo_ps(beta) prod(ps) } # calculate log-likelihood demo_loglikelihood &lt;- function(beta) { ps &lt;- demo_ps(beta) sum(log(ps)) } tibble( beta = seq(-0.2, 0, by = 0.001) ) %&gt;% rowwise() %&gt;% mutate( Likelihood = demo_likelihood(beta), `Log Likelihood` = demo_loglikelihood(beta) ) %&gt;% gather(likelihood, value, -beta) %&gt;% ggplot(aes(x = beta, y = value)) + geom_line() + xlab(expression(beta)) + ylab(&quot;Likelihood Function Value&quot;) + facet_grid(likelihood ~ ., scales = &quot;free_y&quot;) + theme_bw() Figure 4.5: Likelihood and log-likelihood as a function of a parameter value. These include numerical problems, because the MNP can only\nbe calculated using multi-dimensional integration, and problems of\ninterpretation. A special case of the MNP, when the error terms are distributed\nindependently (no covariance) and identically (same variance), obtains\nestimation and prediction results that are very similar to those for the MNL\nmodel.↩︎ A model for which the probability can be calculated without\nuse of numerical integration or simulation methods.↩︎ The exponent of a summation, \\(\\exp(A+B)\\), is equal to the product of\nthe exponents of the elements in the sum, \\(\\\\exp(A) \\exp(B)\\) .↩︎ We use tables to illustrate calculation of the utility\nvalues and MNL probabilities. The first column shows the specification\nexpression with appropriate values for variables and parameters, the second\nshows the calculated utility value, the third shows the exponent of the utility\nincluding the sum of the exponents, and the fourth shows the probability values.↩︎ This example ignores the increase in bus service frequency which\nmight increase the probability of persons choosing bus; however, the increase is\nunlikely to be of the magnitude suggested by the IIA property.↩︎ In this case, we show the preservation of probabilities for the\nindividual. In general, the individual probabilities are expected to change.↩︎ Interested readers are referred to train (1986) for a\nderivation and proof.↩︎ As before, interested readers are referred to Train (1986)\nfor derivation and proof.↩︎ This comparison is independent of which alternative\nis chosen as the reference alternative since the effect of changing the\nreference alternative will be to increase each parameter by the same value.↩︎ Iso-utility lines connect all points for which the values of\ntime and cost result in the same utility. The slope of these lines equals the\ninverse of the value of time, \\(\\beta_1/\\beta_2\\).↩︎ Dependence of \\(P_{j&#39;t}\\) on \\(b\\) is made implicit to simplify\nnotation.↩︎ Dependence of \\(P_{j&#39;t}\\) on \\(b\\) is made implicit to simplify\nnotation.↩︎ "],
["data-assembly-and-estimation-of-simple-multinomial-logit-models.html", "Chapter 5 Data Assembly and Estimation of Simple Multinomial Logit Models 5.1 Introduction 5.2 Data Requirements Overview 5.3 Sources and Methods for Traveler and Trip Related Data Collection 5.4 Methods for Collecting Mode Related Data 5.5 Data STructure for Estimation 5.6 Application Data for Work Mode Choice in the San Francisco Bay Area 5.7 Estimation of MNL Model with Basic Specification 5.8 Value of Time", " Chapter 5 Data Assembly and Estimation of Simple Multinomial Logit Models 5.1 Introduction 5.2 Data Requirements Overview 5.3 Sources and Methods for Traveler and Trip Related Data Collection 5.4 Methods for Collecting Mode Related Data 5.5 Data STructure for Estimation 5.6 Application Data for Work Mode Choice in the San Francisco Bay Area 5.7 Estimation of MNL Model with Basic Specification 5.8 Value of Time "],
["model-specification-refinement.html", "Chapter 6 Model Specification Refinement 6.1 Introduction 6.2 Alternative Specifications 6.3 Market Segmentation 6.4 Summary", " Chapter 6 Model Specification Refinement 6.1 Introduction 6.2 Alternative Specifications 6.3 Market Segmentation 6.4 Summary "],
["san-francisco-bay-area-shop-other-mode-choice.html", "Chapter 7 San Francisco Bay Area Shop / Other Mode Choice 7.1 Introduction 7.2 Specification for Shop/Other Mode Choice Model 7.3 Initial Model Specification 7.4 Exploring Alternative Specifications", " Chapter 7 San Francisco Bay Area Shop / Other Mode Choice 7.1 Introduction 7.2 Specification for Shop/Other Mode Choice Model 7.3 Initial Model Specification 7.4 Exploring Alternative Specifications "],
["nested-logit-model.html", "Chapter 8 Nested Logit Model 8.1 Motivation 8.2 Formulation of Nested Logit Model 8.3 Nesting Structures", " Chapter 8 Nested Logit Model 8.1 Motivation 8.2 Formulation of Nested Logit Model 8.3 Nesting Structures "],
["selecting-a-preferred-nesting-structure.html", "Chapter 9 Selecting a Preferred Nesting Structure 9.1 Introduction 9.2 Nested Models for Work Trips 9.3 Nested Models for Shop / Other Trips 9.4 Practical Issues and Implications", " Chapter 9 Selecting a Preferred Nesting Structure 9.1 Introduction 9.2 Nested Models for Work Trips 9.3 Nested Models for Shop / Other Trips 9.4 Practical Issues and Implications "],
["multiple-maxima-in-nested-logit-estimation.html", "Chapter 10 Multiple Maxima in Nested Logit Estimation", " Chapter 10 Multiple Maxima in Nested Logit Estimation "],
["aggregate-forecasting-assessment-and-application.html", "Chapter 11 Aggregate Forecasting Assessment, and Application 11.1 Background 11.2 Aggregate Forecasting 11.3 Aggregate Assessment of Travel Mode Choice Models", " Chapter 11 Aggregate Forecasting Assessment, and Application 11.1 Background 11.2 Aggregate Forecasting 11.3 Aggregate Assessment of Travel Mode Choice Models "],
["recent-advances-in-discrete-choice-modeling.html", "Chapter 12 Recent Advances in Discrete Choice Modeling 12.1 The GEV Class of Models 12.2 The MMNL Class of Models 12.3 The Mixed GEV Class of Models 12.4 Summary", " Chapter 12 Recent Advances in Discrete Choice Modeling 12.1 The GEV Class of Models 12.2 The MMNL Class of Models 12.3 The Mixed GEV Class of Models 12.4 Summary "],
["references.html", "References", " References "]
]
